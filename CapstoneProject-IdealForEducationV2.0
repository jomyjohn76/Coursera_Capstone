{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Capstone Project - Residential  Area For Education\n",
    "### Applied Data Science Capstone by IBM/Coursera\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Table of contents\n",
    "* [Introduction: Business Problem](#introduction)\n",
    "* [Data](#data)\n",
    "* [Methodology](#methodology)\n",
    "* [Analysis](#analysis)\n",
    "* [Results and Discussion](#results)\n",
    "* [Conclusion](#conclusion)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "\n",
    "## Introduction: Business Problem <a name=\"introduction\"></a>\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In this project we will try to find an optimal location for a better education options available  in Miami. Specifically, this report will be targeted to stakeholders interested in selecting a **residence location** in **Miami**, Florida, USA which has maximum **Education institution**.\n",
    "\n",
    "There are lots educational institutes  available  in  Miami and we will try to detect **locations that has more options for Education**. \n",
    "\n",
    "We will use our data science powers to generate a few most promising  neighborhoods based on this criteria. Advantages of each area will then be clearly expressed so that best possible final location can be chosen by stakeholders."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data <a name=\"data\"></a>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Based on definition of our problem, factors that will influence our decision  are:\n",
    "* Number of existing education institution available in the neighborhood \n",
    "\n",
    "Following data sources will be needed to extract/generate the required information:\n",
    "\n",
    "* Neighborhoods in Miami and its Co-ordinates.\n",
    "This data will be extracted from the following web page.\n",
    "https://en.wikipedia.org/wiki/List_of_neighborhoods_in_Miami\n",
    "\n",
    "\n",
    "* Number of educational institutes and their type and location in every neighborhood will be obtained using **Foursquare API**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Before we get the data and start exploring it, let's download all the dependencies that we will need.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: geopy in c:\\users\\jomyjohn\\anaconda3\\lib\\site-packages (2.0.0)\n",
      "Requirement already satisfied: geographiclib<2,>=1.49 in c:\\users\\jomyjohn\\anaconda3\\lib\\site-packages (from geopy) (1.50)\n",
      "Libraries imported.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np # library to handle data in a vectorized manner\n",
    "\n",
    "import pandas as pd # library for data analsysis\n",
    "pd.set_option('display.max_columns', None)\n",
    "pd.set_option('display.max_rows', None)\n",
    "\n",
    "!pip install geopy\n",
    "\n",
    "import json # library to handle JSON files\n",
    "\n",
    "#!conda install -c conda-forge geopy --yes # uncomment this line if you haven't completed the Foursquare API lab\n",
    "from geopy.geocoders import Nominatim # convert an address into latitude and longitude values\n",
    "\n",
    "import requests # library to handle requests\n",
    "from pandas.io.json import json_normalize # tranform JSON file into a pandas dataframe\n",
    "\n",
    "# Matplotlib and associated plotting modules\n",
    "import matplotlib.cm as cm\n",
    "import matplotlib.colors as colors\n",
    "\n",
    "\n",
    "#!conda install -c conda-forge folium=0.5.0 --yes # uncomment this line if you haven't completed the Foursquare API lab\n",
    "import folium # map rendering library\n",
    "\n",
    "print('Libraries imported.')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='item1'></a>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1. Download and Explore Dataset\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Miami has a total  of 24 neighborhoods. In order to segment  the neighborhoods and explore them, we will essentially need a dataset that contains  the neighborhoods well as the latitude and longitude coordinates of each neighborhood. \n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Load and explore the data\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Next, let's load the data.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "from bs4 import BeautifulSoup\n",
    "import requests\n",
    "\n",
    "url = 'https://en.wikipedia.org/wiki/List_of_neighborhoods_in_Miami'\n",
    "\n",
    "r = requests.get(url)\n",
    "\n",
    "soup = BeautifulSoup(r.content)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "table = soup.find('table')\n",
    "df = pd.read_html(str(table))[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Neighborhood</th>\n",
       "      <th>Demonym</th>\n",
       "      <th>Population2010</th>\n",
       "      <th>Population/Km²</th>\n",
       "      <th>Sub-neighborhoods</th>\n",
       "      <th>Coordinates</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>NaN</td>\n",
       "      <td>54289</td>\n",
       "      <td>4401</td>\n",
       "      <td>NaN</td>\n",
       "      <td>25.815-80.224</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arts &amp; Entertainment District</td>\n",
       "      <td>NaN</td>\n",
       "      <td>11033</td>\n",
       "      <td>7948</td>\n",
       "      <td>NaN</td>\n",
       "      <td>25.799-80.190</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Brickell</td>\n",
       "      <td>Brickellite</td>\n",
       "      <td>31759</td>\n",
       "      <td>14541</td>\n",
       "      <td>West Brickell</td>\n",
       "      <td>25.758-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Buena Vista</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9058</td>\n",
       "      <td>3540</td>\n",
       "      <td>Buena Vista East Historic District and Design ...</td>\n",
       "      <td>25.813-80.192</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Coconut Grove</td>\n",
       "      <td>Grovite</td>\n",
       "      <td>20076</td>\n",
       "      <td>3091</td>\n",
       "      <td>Center Grove, Northeast Coconut Grove, Southwe...</td>\n",
       "      <td>25.712-80.257</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    Neighborhood      Demonym Population2010 Population/Km²  \\\n",
       "0                     Allapattah          NaN          54289           4401   \n",
       "1  Arts & Entertainment District          NaN          11033           7948   \n",
       "2                       Brickell  Brickellite          31759          14541   \n",
       "3                    Buena Vista          NaN           9058           3540   \n",
       "4                  Coconut Grove      Grovite          20076           3091   \n",
       "\n",
       "                                   Sub-neighborhoods    Coordinates  \n",
       "0                                                NaN  25.815-80.224  \n",
       "1                                                NaN  25.799-80.190  \n",
       "2                                      West Brickell  25.758-80.193  \n",
       "3  Buena Vista East Historic District and Design ...  25.813-80.192  \n",
       "4  Center Grove, Northeast Coconut Grove, Southwe...  25.712-80.257  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Remove columns which is not required"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.drop([\"Demonym\",\"Population2010\",\"Population/Km²\",\"Sub-neighborhoods\"], axis = 1, inplace=True) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Remove rows which has no coordinate value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.drop(df[df['Coordinates'].isnull()].index, inplace=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Split the coordinate in to Latitude and Longitude columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "df[['Latitude','Longitude']] = df['Coordinates'].str.split('-',expand=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "remove the Coordinates columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.drop([\"Coordinates\"], axis = 1, inplace=True) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "While splitiing columns we lost -, just add that to longitude."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['Longitude'] = '-' + df['Longitude']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 24 entries, 0 to 24\n",
      "Data columns (total 3 columns):\n",
      " #   Column        Non-Null Count  Dtype \n",
      "---  ------        --------------  ----- \n",
      " 0   Neighborhood  24 non-null     object\n",
      " 1   Latitude      24 non-null     object\n",
      " 2   Longitude     24 non-null     object\n",
      "dtypes: object(3)\n",
      "memory usage: 768.0+ bytes\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Convert Latitude and Longitude columns to flot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "df[['Latitude', 'Longitude']] = df[['Latitude', 'Longitude']].apply(pd.to_numeric)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "neighborhoods = df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's take a quick look at the data.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Neighborhood</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>25.815</td>\n",
       "      <td>-80.224</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arts &amp; Entertainment District</td>\n",
       "      <td>25.799</td>\n",
       "      <td>-80.190</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Brickell</td>\n",
       "      <td>25.758</td>\n",
       "      <td>-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Buena Vista</td>\n",
       "      <td>25.813</td>\n",
       "      <td>-80.192</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Coconut Grove</td>\n",
       "      <td>25.712</td>\n",
       "      <td>-80.257</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    Neighborhood  Latitude  Longitude\n",
       "0                     Allapattah    25.815    -80.224\n",
       "1  Arts & Entertainment District    25.799    -80.190\n",
       "2                       Brickell    25.758    -80.193\n",
       "3                    Buena Vista    25.813    -80.192\n",
       "4                  Coconut Grove    25.712    -80.257"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "neighborhoods.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Take a look at the empty dataframe to confirm that the columns are as intended.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The dataframe has 24 neighborhoods.\n"
     ]
    }
   ],
   "source": [
    "print('The dataframe has {} neighborhoods.'.format(neighborhoods.shape[0]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Use geopy library to get the latitude and longitude values of Miami City.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In order to define an instance of the geocoder, we need to define a user_agent. We will name our agent <em>ny_explorer</em>, as shown below.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The geograpical coordinate of Miami City are 25.7742658, -80.1936589.\n"
     ]
    }
   ],
   "source": [
    "address = 'Miami, FL'\n",
    "\n",
    "geolocator = Nominatim(user_agent=\"ny_explorer\")\n",
    "location = geolocator.geocode(address)\n",
    "latitude = location.latitude\n",
    "longitude = location.longitude\n",
    "print('The geograpical coordinate of Miami City are {}, {}.'.format(latitude, longitude))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Create a map of Miami with neighborhoods superimposed on top.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe src=\"about:blank\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" data-html=PCFET0NUWVBFIGh0bWw+CjxoZWFkPiAgICAKICAgIDxtZXRhIGh0dHAtZXF1aXY9ImNvbnRlbnQtdHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PVVURi04IiAvPgogICAgPHNjcmlwdD5MX1BSRUZFUl9DQU5WQVMgPSBmYWxzZTsgTF9OT19UT1VDSCA9IGZhbHNlOyBMX0RJU0FCTEVfM0QgPSBmYWxzZTs8L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL2pxdWVyeS8xLjExLjEvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvanMvYm9vdHN0cmFwLm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuanMiPjwvc2NyaXB0PgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLm1pbi5jc3MiLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC10aGVtZS5taW4uY3NzIi8+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuNi4zL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9MZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy8yLjAuMi9sZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy5jc3MiLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9yYXdnaXQuY29tL3B5dGhvbi12aXN1YWxpemF0aW9uL2ZvbGl1bS9tYXN0ZXIvZm9saXVtL3RlbXBsYXRlcy9sZWFmbGV0LmF3ZXNvbWUucm90YXRlLmNzcyIvPgogICAgPHN0eWxlPmh0bWwsIGJvZHkge3dpZHRoOiAxMDAlO2hlaWdodDogMTAwJTttYXJnaW46IDA7cGFkZGluZzogMDt9PC9zdHlsZT4KICAgIDxzdHlsZT4jbWFwIHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3R0b206MDtyaWdodDowO2xlZnQ6MDt9PC9zdHlsZT4KICAgIAogICAgICAgICAgICA8c3R5bGU+ICNtYXBfMGJlODFlNTRkNDlmNGY5Mzg5OGM1NWM4NzY4N2Y2YzAgewogICAgICAgICAgICAgICAgcG9zaXRpb24gOiByZWxhdGl2ZTsKICAgICAgICAgICAgICAgIHdpZHRoIDogMTAwLjAlOwogICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAuMCU7CiAgICAgICAgICAgICAgICBsZWZ0OiAwLjAlOwogICAgICAgICAgICAgICAgdG9wOiAwLjAlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICA8L3N0eWxlPgogICAgICAgIAo8L2hlYWQ+Cjxib2R5PiAgICAKICAgIAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb2xpdW0tbWFwIiBpZD0ibWFwXzBiZTgxZTU0ZDQ5ZjRmOTM4OThjNTVjODc2ODdmNmMwIiA+PC9kaXY+CiAgICAgICAgCjwvYm9keT4KPHNjcmlwdD4gICAgCiAgICAKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGJvdW5kcyA9IG51bGw7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcF8wYmU4MWU1NGQ0OWY0ZjkzODk4YzU1Yzg3Njg3ZjZjMCA9IEwubWFwKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hcF8wYmU4MWU1NGQ0OWY0ZjkzODk4YzU1Yzg3Njg3ZjZjMCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2VudGVyOiBbMjUuNzc0MjY1OCwtODAuMTkzNjU4OV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6b29tOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heEJvdW5kczogYm91bmRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXJzOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmxkQ29weUp1bXA6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JzOiBMLkNSUy5FUFNHMzg1NwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHRpbGVfbGF5ZXJfZGQwNDE5ZmNkOTYyNDcwNmFlZTQwMTA4MjEzZjM5YTUgPSBMLnRpbGVMYXllcigKICAgICAgICAgICAgICAgICdodHRwczovL3tzfS50aWxlLm9wZW5zdHJlZXRtYXAub3JnL3t6fS97eH0ve3l9LnBuZycsCiAgICAgICAgICAgICAgICB7CiAgImF0dHJpYnV0aW9uIjogbnVsbCwKICAiZGV0ZWN0UmV0aW5hIjogZmFsc2UsCiAgIm1heFpvb20iOiAxOCwKICAibWluWm9vbSI6IDEsCiAgIm5vV3JhcCI6IGZhbHNlLAogICJzdWJkb21haW5zIjogImFiYyIKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGJlODFlNTRkNDlmNGY5Mzg5OGM1NWM4NzY4N2Y2YzApOwogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2EzNmI5YjE0MDE0MjQ0NDZiZjI3NGMxMTVjYjA1NzZlID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuODE1LC04MC4yMjM5OTk5OTk5OTk5OV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzMxODZjYyIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYmU4MWU1NGQ0OWY0ZjkzODk4YzU1Yzg3Njg3ZjZjMCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9lMzdiYzJjZDg5NzY0MzBhOTc2ZTc0YTE3NTk5MzIyYSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8zODI0ZTRkMWM3MmI0NzMzOThiMGZjNGJhYmYyNTQ5YyA9ICQoJzxkaXYgaWQ9Imh0bWxfMzgyNGU0ZDFjNzJiNDczMzk4YjBmYzRiYWJmMjU0OWMiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkFsbGFwYXR0YWg8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2UzN2JjMmNkODk3NjQzMGE5NzZlNzRhMTc1OTkzMjJhLnNldENvbnRlbnQoaHRtbF8zODI0ZTRkMWM3MmI0NzMzOThiMGZjNGJhYmYyNTQ5Yyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9hMzZiOWIxNDAxNDI0NDQ2YmYyNzRjMTE1Y2IwNTc2ZS5iaW5kUG9wdXAocG9wdXBfZTM3YmMyY2Q4OTc2NDMwYTk3NmU3NGExNzU5OTMyMmEpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNjEwODlmNDUwNjBkNDdmZWI0MzJmYzZlZmUyOWJhYmMgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS43OTksLTgwLjE5XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjMzE4NmNjIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBiZTgxZTU0ZDQ5ZjRmOTM4OThjNTVjODc2ODdmNmMwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzFjNjRkODljYTk4YzQzYmJhMjg2ZDBiZTY5MzY1ZTdkID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzYyMTk5NWY2NjdhOTQ5OWQ5ZmJmZjUzZTdjNzZlZWU4ID0gJCgnPGRpdiBpZD0iaHRtbF82MjE5OTVmNjY3YTk0OTlkOWZiZmY1M2U3Yzc2ZWVlOCIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QXJ0cyAmYW1wOyBFbnRlcnRhaW5tZW50IERpc3RyaWN0PC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8xYzY0ZDg5Y2E5OGM0M2JiYTI4NmQwYmU2OTM2NWU3ZC5zZXRDb250ZW50KGh0bWxfNjIxOTk1ZjY2N2E5NDk5ZDlmYmZmNTNlN2M3NmVlZTgpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNjEwODlmNDUwNjBkNDdmZWI0MzJmYzZlZmUyOWJhYmMuYmluZFBvcHVwKHBvcHVwXzFjNjRkODljYTk4YzQzYmJhMjg2ZDBiZTY5MzY1ZTdkKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2U2OGU4NzZlYTkxNDQ4MDU4YzUwMTdkZTI1ZGE2ZmQ3ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuNzU4MDAwMDAwMDAwMDAzLC04MC4xOTNdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiMzMTg2Y2MiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGJlODFlNTRkNDlmNGY5Mzg5OGM1NWM4NzY4N2Y2YzApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNTYxYjlmNTc3Nzg2NDlmMDgzYzQ5NjI1MmY1YzJmNjggPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMTMwODdmMDY4NGViNGE5NzgyNWM4NDZhY2ZjM2JjOTggPSAkKCc8ZGl2IGlkPSJodG1sXzEzMDg3ZjA2ODRlYjRhOTc4MjVjODQ2YWNmYzNiYzk4IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5Ccmlja2VsbDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfNTYxYjlmNTc3Nzg2NDlmMDgzYzQ5NjI1MmY1YzJmNjguc2V0Q29udGVudChodG1sXzEzMDg3ZjA2ODRlYjRhOTc4MjVjODQ2YWNmYzNiYzk4KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyX2U2OGU4NzZlYTkxNDQ4MDU4YzUwMTdkZTI1ZGE2ZmQ3LmJpbmRQb3B1cChwb3B1cF81NjFiOWY1Nzc3ODY0OWYwODNjNDk2MjUyZjVjMmY2OCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl9mMmRlZmJlYjEzZjc0NGE1OTkzYzZkNDk0N2Y5NWZhMiA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1LjgxMzAwMDAwMDAwMDAwMiwtODAuMTkyXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjMzE4NmNjIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBiZTgxZTU0ZDQ5ZjRmOTM4OThjNTVjODc2ODdmNmMwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2VlZjFmMTZkMDVjZTRmMWJhYzBiNzFlMjcwODEzODUwID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2Y1MTJhMGMzNmQ3MjQ5OTc4MGVkMmUxNDI0OTJkNjdlID0gJCgnPGRpdiBpZD0iaHRtbF9mNTEyYTBjMzZkNzI0OTk3ODBlZDJlMTQyNDkyZDY3ZSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QnVlbmEgVmlzdGE8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2VlZjFmMTZkMDVjZTRmMWJhYzBiNzFlMjcwODEzODUwLnNldENvbnRlbnQoaHRtbF9mNTEyYTBjMzZkNzI0OTk3ODBlZDJlMTQyNDkyZDY3ZSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9mMmRlZmJlYjEzZjc0NGE1OTkzYzZkNDk0N2Y5NWZhMi5iaW5kUG9wdXAocG9wdXBfZWVmMWYxNmQwNWNlNGYxYmFjMGI3MWUyNzA4MTM4NTApOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfN2Q5ZDBhMmVmZjg2NDI5MmE4ZDQ5NWE0OWUxMTkzMzcgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS43MTIsLTgwLjI1N10sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzMxODZjYyIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYmU4MWU1NGQ0OWY0ZjkzODk4YzU1Yzg3Njg3ZjZjMCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9kOWFjZWFmMzc3YjE0OTIwODU4YmRhY2JlN2FiZjdmNiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8xMTNjZmUxOWMxNmU0ZGNhYmJhZTY3NjYwZmY2NzNhNyA9ICQoJzxkaXYgaWQ9Imh0bWxfMTEzY2ZlMTljMTZlNGRjYWJiYWU2NzY2MGZmNjczYTciIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkNvY29udXQgR3JvdmU8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2Q5YWNlYWYzNzdiMTQ5MjA4NThiZGFjYmU3YWJmN2Y2LnNldENvbnRlbnQoaHRtbF8xMTNjZmUxOWMxNmU0ZGNhYmJhZTY3NjYwZmY2NzNhNyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl83ZDlkMGEyZWZmODY0MjkyYThkNDk1YTQ5ZTExOTMzNy5iaW5kUG9wdXAocG9wdXBfZDlhY2VhZjM3N2IxNDkyMDg1OGJkYWNiZTdhYmY3ZjYpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfYWY1NmFlYTBhOGY4NDk4MWEzZDkwYjVlMzFjMjcyNWQgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS43NSwtODAuMjgzXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjMzE4NmNjIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBiZTgxZTU0ZDQ5ZjRmOTM4OThjNTVjODc2ODdmNmMwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2Q2NjEyNGJhOTJkZDRiYjI4ODdkNWVjNTY4OWY3ZjIwID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2Y3ZjQzN2EwYzQ2ZTQ2ZTM5ODY2ODE5M2JiZjM2OTliID0gJCgnPGRpdiBpZD0iaHRtbF9mN2Y0MzdhMGM0NmU0NmUzOTg2NjgxOTNiYmYzNjk5YiIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+Q29yYWwgV2F5PC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9kNjYxMjRiYTkyZGQ0YmIyODg3ZDVlYzU2ODlmN2YyMC5zZXRDb250ZW50KGh0bWxfZjdmNDM3YTBjNDZlNDZlMzk4NjY4MTkzYmJmMzY5OWIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfYWY1NmFlYTBhOGY4NDk4MWEzZDkwYjVlMzFjMjcyNWQuYmluZFBvcHVwKHBvcHVwX2Q2NjEyNGJhOTJkZDRiYjI4ODdkNWVjNTY4OWY3ZjIwKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzM2OTgwNWFhZmJmZjRmYTY5YWM1ZTM2MjhhYjMyNGNiID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuODEzMDAwMDAwMDAwMDAyLC04MC4xOTNdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiMzMTg2Y2MiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGJlODFlNTRkNDlmNGY5Mzg5OGM1NWM4NzY4N2Y2YzApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNTZjN2VjYjY0NTMxNDhmYWI1ZTgyOTliNzFkNjk2ZjcgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMjUyMDYzZGJlMzVmNDFkOGEwZDhmMTZjZjA4Y2ZjYzQgPSAkKCc8ZGl2IGlkPSJodG1sXzI1MjA2M2RiZTM1ZjQxZDhhMGQ4ZjE2Y2YwOGNmY2M0IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5EZXNpZ24gRGlzdHJpY3Q8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzU2YzdlY2I2NDUzMTQ4ZmFiNWU4Mjk5YjcxZDY5NmY3LnNldENvbnRlbnQoaHRtbF8yNTIwNjNkYmUzNWY0MWQ4YTBkOGYxNmNmMDhjZmNjNCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8zNjk4MDVhYWZiZmY0ZmE2OWFjNWUzNjI4YWIzMjRjYi5iaW5kUG9wdXAocG9wdXBfNTZjN2VjYjY0NTMxNDhmYWI1ZTgyOTliNzFkNjk2ZjcpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfOWE3ZDNkMjRkNGE0NDBhNzllOWIwMzEwNjAxOTYwNTUgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS43NzQsLTgwLjE5M10sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzMxODZjYyIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYmU4MWU1NGQ0OWY0ZjkzODk4YzU1Yzg3Njg3ZjZjMCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9lYTNlZmNlNDAxMjA0NjAzYjNlM2RhYjljYjNmZDFjMyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9lYzk0NTgwOTE5ZDM0M2YzYWQ2NWNlNDhmMjU0YTI5MiA9ICQoJzxkaXYgaWQ9Imh0bWxfZWM5NDU4MDkxOWQzNDNmM2FkNjVjZTQ4ZjI1NGEyOTIiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkRvd250b3duPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9lYTNlZmNlNDAxMjA0NjAzYjNlM2RhYjljYjNmZDFjMy5zZXRDb250ZW50KGh0bWxfZWM5NDU4MDkxOWQzNDNmM2FkNjVjZTQ4ZjI1NGEyOTIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfOWE3ZDNkMjRkNGE0NDBhNzllOWIwMzEwNjAxOTYwNTUuYmluZFBvcHVwKHBvcHVwX2VhM2VmY2U0MDEyMDQ2MDNiM2UzZGFiOWNiM2ZkMWMzKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2EzMTZhNWU1OTU3ZDRmNzhiNzUzNWM1ODI3MDcwNGYyID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuODAyLC04MC4xOV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzMxODZjYyIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYmU4MWU1NGQ0OWY0ZjkzODk4YzU1Yzg3Njg3ZjZjMCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9mZTg4YjhkM2NhOGI0MzYwOWRmYzFiMzdlNmZhMmI0YyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF81YWI5NDhlZDliNWY0Yjg2OTAyZmNkNDIxYWE2MjVkNSA9ICQoJzxkaXYgaWQ9Imh0bWxfNWFiOTQ4ZWQ5YjVmNGI4NjkwMmZjZDQyMWFhNjI1ZDUiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkVkZ2V3YXRlcjwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZmU4OGI4ZDNjYThiNDM2MDlkZmMxYjM3ZTZmYTJiNGMuc2V0Q29udGVudChodG1sXzVhYjk0OGVkOWI1ZjRiODY5MDJmY2Q0MjFhYTYyNWQ1KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyX2EzMTZhNWU1OTU3ZDRmNzhiNzUzNWM1ODI3MDcwNGYyLmJpbmRQb3B1cChwb3B1cF9mZTg4YjhkM2NhOGI0MzYwOWRmYzFiMzdlNmZhMmI0Yyk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl9iYzQ2YzE4ZjUyZmE0ZDcxYjc5ZmNiNDA5YzhhMzAyZiA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1Ljc2MTk5OTk5OTk5OTk5NywtODAuMzE2XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjMzE4NmNjIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBiZTgxZTU0ZDQ5ZjRmOTM4OThjNTVjODc2ODdmNmMwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzdmYTA3OTFhNjUyZTQ1YWJhMDZmZGE0NDk5Zjg4ZjNkID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzRhZDY1MmZmNTg0OTQzYWU5OTA5ZGMyM2JlMDY1NTdkID0gJCgnPGRpdiBpZD0iaHRtbF80YWQ2NTJmZjU4NDk0M2FlOTkwOWRjMjNiZTA2NTU3ZCIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+RmxhZ2FtaTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfN2ZhMDc5MWE2NTJlNDVhYmEwNmZkYTQ0OTlmODhmM2Quc2V0Q29udGVudChodG1sXzRhZDY1MmZmNTg0OTQzYWU5OTA5ZGMyM2JlMDY1NTdkKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyX2JjNDZjMThmNTJmYTRkNzFiNzlmY2I0MDljOGEzMDJmLmJpbmRQb3B1cChwb3B1cF83ZmEwNzkxYTY1MmU0NWFiYTA2ZmRhNDQ5OWY4OGYzZCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl82YzVmNDNhZDNmYWM0ODkyOTA3NTRmNTBjMWIxYWY4NyA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1Ljc5MTk5OTk5OTk5OTk5OCwtODAuMjU4XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjMzE4NmNjIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBiZTgxZTU0ZDQ5ZjRmOTM4OThjNTVjODc2ODdmNmMwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2UxYzQ3ZjIzZmY0MzRkNWI4ZmNhZTU3YzM2MTlmZDgyID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzI0MzgwMzY5MGQzZTRjOGNiYWYyZmZkMGMzODA5MjYwID0gJCgnPGRpdiBpZD0iaHRtbF8yNDM4MDM2OTBkM2U0YzhjYmFmMmZmZDBjMzgwOTI2MCIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+R3JhcGVsYW5kIEhlaWdodHM8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2UxYzQ3ZjIzZmY0MzRkNWI4ZmNhZTU3YzM2MTlmZDgyLnNldENvbnRlbnQoaHRtbF8yNDM4MDM2OTBkM2U0YzhjYmFmMmZmZDBjMzgwOTI2MCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl82YzVmNDNhZDNmYWM0ODkyOTA3NTRmNTBjMWIxYWY4Ny5iaW5kUG9wdXAocG9wdXBfZTFjNDdmMjNmZjQzNGQ1YjhmY2FlNTdjMzYxOWZkODIpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNGFkZDkxY2Y2YzZkNDRmYmEzOGRhNjQ1ZDZkOTM2NjcgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS44MzE5OTk5OTk5OTk5OTcsLTgwLjIyNV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzMxODZjYyIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYmU4MWU1NGQ0OWY0ZjkzODk4YzU1Yzg3Njg3ZjZjMCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8wMmE2YTdmZWY5NzI0MGI0YTNmMGY1ZjRiNThlYmUwMCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8wNGMwNjk3ZWRlYTk0YzBjOWM3OTcxMGNhMmE2YzEwYSA9ICQoJzxkaXYgaWQ9Imh0bWxfMDRjMDY5N2VkZWE5NGMwYzljNzk3MTBjYTJhNmMxMGEiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkxpYmVydHkgQ2l0eTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMDJhNmE3ZmVmOTcyNDBiNGEzZjBmNWY0YjU4ZWJlMDAuc2V0Q29udGVudChodG1sXzA0YzA2OTdlZGVhOTRjMGM5Yzc5NzEwY2EyYTZjMTBhKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzRhZGQ5MWNmNmM2ZDQ0ZmJhMzhkYTY0NWQ2ZDkzNjY3LmJpbmRQb3B1cChwb3B1cF8wMmE2YTdmZWY5NzI0MGI0YTNmMGY1ZjRiNThlYmUwMCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl82NTQ2ZjdiMGY3ODA0YzhjYjIwODc1ZTc4YjhlYmQ3ZiA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1LjgyNCwtODAuMTkxXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjMzE4NmNjIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBiZTgxZTU0ZDQ5ZjRmOTM4OThjNTVjODc2ODdmNmMwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzkwMzc4ZDcyMDM3YjQ1ZTg5ZmY3ZGU5ODg1MGIxMWMwID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzVkZTU2MmRkN2Y2ZTRhOGY5NjFiMDQwZDBmMjhjZDkyID0gJCgnPGRpdiBpZD0iaHRtbF81ZGU1NjJkZDdmNmU0YThmOTYxYjA0MGQwZjI4Y2Q5MiIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+TGl0dGxlIEhhaXRpPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF85MDM3OGQ3MjAzN2I0NWU4OWZmN2RlOTg4NTBiMTFjMC5zZXRDb250ZW50KGh0bWxfNWRlNTYyZGQ3ZjZlNGE4Zjk2MWIwNDBkMGYyOGNkOTIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNjU0NmY3YjBmNzgwNGM4Y2IyMDg3NWU3OGI4ZWJkN2YuYmluZFBvcHVwKHBvcHVwXzkwMzc4ZDcyMDM3YjQ1ZTg5ZmY3ZGU5ODg1MGIxMWMwKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzhkZDE0YTQwNGQ3YzQ0NWY5ZWYwYzljMGE3MTJhODdiID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuNzczMDAwMDAwMDAwMDAzLC04MC4yMTVdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiMzMTg2Y2MiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGJlODFlNTRkNDlmNGY5Mzg5OGM1NWM4NzY4N2Y2YzApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfM2NiOTExZjc2MDA1NDg2NmE5NTE1YjYxZTc1MGY0YzYgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMmU3NTdkZmQ5OGIyNGQ0NmFmYTY5NDBhYWQwYWNiMmYgPSAkKCc8ZGl2IGlkPSJodG1sXzJlNzU3ZGZkOThiMjRkNDZhZmE2OTQwYWFkMGFjYjJmIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5MaXR0bGUgSGF2YW5hPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8zY2I5MTFmNzYwMDU0ODY2YTk1MTViNjFlNzUwZjRjNi5zZXRDb250ZW50KGh0bWxfMmU3NTdkZmQ5OGIyNGQ0NmFmYTY5NDBhYWQwYWNiMmYpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfOGRkMTRhNDA0ZDdjNDQ1ZjllZjBjOWMwYTcxMmE4N2IuYmluZFBvcHVwKHBvcHVwXzNjYjkxMWY3NjAwNTQ4NjZhOTUxNWI2MWU3NTBmNGM2KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2M2NDFiMzhlMDFmMTQzOWY5ZWI5MzBmY2NmMGI0NjEzID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuNzc2OTk5OTk5OTk5OTk3LC04MC4yMDEwMDAwMDAwMDAwMV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzMxODZjYyIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYmU4MWU1NGQ0OWY0ZjkzODk4YzU1Yzg3Njg3ZjZjMCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF85M2E4M2FlYjk4YTI0YmFmYmI1NWY1MmRkYzI3ZTNkYyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9iNTk0ZDlmN2E5ODM0ZThlYmRkZjdhMTk5MTE0ZjQ1NCA9ICQoJzxkaXYgaWQ9Imh0bWxfYjU5NGQ5ZjdhOTgzNGU4ZWJkZGY3YTE5OTExNGY0NTQiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkx1bW11cyBQYXJrPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF85M2E4M2FlYjk4YTI0YmFmYmI1NWY1MmRkYzI3ZTNkYy5zZXRDb250ZW50KGh0bWxfYjU5NGQ5ZjdhOTgzNGU4ZWJkZGY3YTE5OTExNGY0NTQpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfYzY0MWIzOGUwMWYxNDM5ZjllYjkzMGZjY2YwYjQ2MTMuYmluZFBvcHVwKHBvcHVwXzkzYTgzYWViOThhMjRiYWZiYjU1ZjUyZGRjMjdlM2RjKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzExMGVkZjA4MmRjNTQ4YTQ5MWIzOWRiMGIzM2NhZjg3ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuODA3LC04MC4xOTNdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiMzMTg2Y2MiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGJlODFlNTRkNDlmNGY5Mzg5OGM1NWM4NzY4N2Y2YzApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfOGQ3NzAyZmQzOTQxNDdiN2JkMzc4OTBkZGQ3ZDkzNWEgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMDgyMDBjNmY4MTNlNDZkY2E1YjFmNDU3MDE5MWEyNWUgPSAkKCc8ZGl2IGlkPSJodG1sXzA4MjAwYzZmODEzZTQ2ZGNhNWIxZjQ1NzAxOTFhMjVlIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5NaWR0b3duPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF84ZDc3MDJmZDM5NDE0N2I3YmQzNzg5MGRkZDdkOTM1YS5zZXRDb250ZW50KGh0bWxfMDgyMDBjNmY4MTNlNDZkY2E1YjFmNDU3MDE5MWEyNWUpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfMTEwZWRmMDgyZGM1NDhhNDkxYjM5ZGIwYjMzY2FmODcuYmluZFBvcHVwKHBvcHVwXzhkNzcwMmZkMzk0MTQ3YjdiZDM3ODkwZGRkN2Q5MzVhKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzllYzk3MzVhM2QzODQ2ODJiYTI4MjQ3MTMyNTdlM2Q5ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuNzg3LC04MC4yMDEwMDAwMDAwMDAwMV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzMxODZjYyIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYmU4MWU1NGQ0OWY0ZjkzODk4YzU1Yzg3Njg3ZjZjMCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9iMWE5MWIzODE5YmE0YzBmYjc2NTY2Njc5MWMxZGYyNyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9kZTc0MmU5MzFiNmU0ZWNiYjRjZmI3NWNhNmFjMWVlMSA9ICQoJzxkaXYgaWQ9Imh0bWxfZGU3NDJlOTMxYjZlNGVjYmI0Y2ZiNzVjYTZhYzFlZTEiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPk92ZXJ0b3duPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9iMWE5MWIzODE5YmE0YzBmYjc2NTY2Njc5MWMxZGYyNy5zZXRDb250ZW50KGh0bWxfZGU3NDJlOTMxYjZlNGVjYmI0Y2ZiNzVjYTZhYzFlZTEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfOWVjOTczNWEzZDM4NDY4MmJhMjgyNDcxMzI1N2UzZDkuYmluZFBvcHVwKHBvcHVwX2IxYTkxYjM4MTliYTRjMGZiNzY1NjY2NzkxYzFkZjI3KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzljZGI0ZDhjNTlhNTQ1NjI4OWU1MmUwYzkwNmM1MWU1ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuNzg1LC04MC4xOTNdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiMzMTg2Y2MiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGJlODFlNTRkNDlmNGY5Mzg5OGM1NWM4NzY4N2Y2YzApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNmZiZWYzMTQ2MmVjNDlmMzhjOTIxYjgwYTMzOTNhYTQgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNDBiOWIwNDRmYmRkNDQxMmJmYzRiNzQ4NWMxNjgxYjMgPSAkKCc8ZGl2IGlkPSJodG1sXzQwYjliMDQ0ZmJkZDQ0MTJiZmM0Yjc0ODVjMTY4MWIzIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5QYXJrIFdlc3Q8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzZmYmVmMzE0NjJlYzQ5ZjM4YzkyMWI4MGEzMzkzYWE0LnNldENvbnRlbnQoaHRtbF80MGI5YjA0NGZiZGQ0NDEyYmZjNGI3NDg1YzE2ODFiMyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl85Y2RiNGQ4YzU5YTU0NTYyODllNTJlMGM5MDZjNTFlNS5iaW5kUG9wdXAocG9wdXBfNmZiZWYzMTQ2MmVjNDlmMzhjOTIxYjgwYTMzOTNhYTQpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfOGYzZjlhZWNhMWYzNDAwMGJkZjUxZmY2MDI1NjAzNjUgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS43NTYsLTgwLjIwN10sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzMxODZjYyIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYmU4MWU1NGQ0OWY0ZjkzODk4YzU1Yzg3Njg3ZjZjMCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8wNTZiNjcwOWQwZjQ0NGRjYjNkNTdhMzY5MTAzYTEwNiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF84MThjZTBiYmVlYjI0M2QwYmVmMzFiYjRlMTQ2NDVhMyA9ICQoJzxkaXYgaWQ9Imh0bWxfODE4Y2UwYmJlZWIyNDNkMGJlZjMxYmI0ZTE0NjQ1YTMiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPlRoZSBSb2FkczwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMDU2YjY3MDlkMGY0NDRkY2IzZDU3YTM2OTEwM2ExMDYuc2V0Q29udGVudChodG1sXzgxOGNlMGJiZWViMjQzZDBiZWYzMWJiNGUxNDY0NWEzKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzhmM2Y5YWVjYTFmMzQwMDBiZGY1MWZmNjAyNTYwMzY1LmJpbmRQb3B1cChwb3B1cF8wNTZiNjcwOWQwZjQ0NGRjYjNkNTdhMzY5MTAzYTEwNik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl80OGU0ZTgwMmZjMTk0MTg5YTcxZjkyMThjZDViZDIxOCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1LjgzLC04MC4xODNdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiMzMTg2Y2MiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGJlODFlNTRkNDlmNGY5Mzg5OGM1NWM4NzY4N2Y2YzApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfYWMwOTljMzIxOGM2NGJlNGEyNTQzMzMxYmQwMmEyYWUgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMTRiZjU3Y2EwMzMxNDk0NDg1M2ViNWY5YzUzYTMxOTMgPSAkKCc8ZGl2IGlkPSJodG1sXzE0YmY1N2NhMDMzMTQ5NDQ4NTNlYjVmOWM1M2EzMTkzIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5VcHBlciBFYXN0c2lkZTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfYWMwOTljMzIxOGM2NGJlNGEyNTQzMzMxYmQwMmEyYWUuc2V0Q29udGVudChodG1sXzE0YmY1N2NhMDMzMTQ5NDQ4NTNlYjVmOWM1M2EzMTkzKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzQ4ZTRlODAyZmMxOTQxODlhNzFmOTIxOGNkNWJkMjE4LmJpbmRQb3B1cChwb3B1cF9hYzA5OWMzMjE4YzY0YmU0YTI1NDMzMzFiZDAyYTJhZSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl84MTMzZmI3ZWJhNTY0NjgzYWI4ZjE3Y2EyYTkyNzlmOSA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1Ljc5MSwtODAuMTYxXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjMzE4NmNjIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBiZTgxZTU0ZDQ5ZjRmOTM4OThjNTVjODc2ODdmNmMwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzRiYjZiMDRlMTUzNDRjYjJiMDQ5YmQwYTFmNTFlNGMzID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2MxMzNlNDFiYTRiMzRjODFiZTkwNjg3NmEwZGNkNWUxID0gJCgnPGRpdiBpZD0iaHRtbF9jMTMzZTQxYmE0YjM0YzgxYmU5MDY4NzZhMGRjZDVlMSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+VmVuZXRpYW4gSXNsYW5kczwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfNGJiNmIwNGUxNTM0NGNiMmIwNDliZDBhMWY1MWU0YzMuc2V0Q29udGVudChodG1sX2MxMzNlNDFiYTRiMzRjODFiZTkwNjg3NmEwZGNkNWUxKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzgxMzNmYjdlYmE1NjQ2ODNhYjhmMTdjYTJhOTI3OWY5LmJpbmRQb3B1cChwb3B1cF80YmI2YjA0ZTE1MzQ0Y2IyYjA0OWJkMGExZjUxZTRjMyk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl81NjU4MzBlNWM5NzA0MGNhYTA2YTYzMTlhMDdlNDNhMiA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1LjczNiwtODAuMTU1XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogImJsdWUiLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICIjMzE4NmNjIiwKICAiZmlsbE9wYWNpdHkiOiAwLjcsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA1LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzBiZTgxZTU0ZDQ5ZjRmOTM4OThjNTVjODc2ODdmNmMwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzMyMTJkMGQ0M2RiMTQ5ZjZiMDQ1MjFmZWUwNWY3ZDViID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzkzYzljNjkwOTg0NzQxNWZiNDY3YTM4MDIzOTZlNTZhID0gJCgnPGRpdiBpZD0iaHRtbF85M2M5YzY5MDk4NDc0MTVmYjQ2N2EzODAyMzk2ZTU2YSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+VmlyZ2luaWEgS2V5PC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8zMjEyZDBkNDNkYjE0OWY2YjA0NTIxZmVlMDVmN2Q1Yi5zZXRDb250ZW50KGh0bWxfOTNjOWM2OTA5ODQ3NDE1ZmI0NjdhMzgwMjM5NmU1NmEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNTY1ODMwZTVjOTcwNDBjYWEwNmE2MzE5YTA3ZTQzYTIuYmluZFBvcHVwKHBvcHVwXzMyMTJkMGQ0M2RiMTQ5ZjZiMDQ1MjFmZWUwNWY3ZDViKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2U3NzVmMDJiYzllOTRiMjY5NGZmNWU5YTAxN2M1NmRkID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuNzc1LC04MC4yNDNdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAiYmx1ZSIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogIiMzMTg2Y2MiLAogICJmaWxsT3BhY2l0eSI6IDAuNywKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfMGJlODFlNTRkNDlmNGY5Mzg5OGM1NWM4NzY4N2Y2YzApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfOGE0YzFmYzYxZTYyNDhlMTkyOTk1NzUxZDkzZTlhYjIgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNTQzNmU4NmU3Nzk4NDVmNzg2OWY4NTE3OTgxZWYzMzUgPSAkKCc8ZGl2IGlkPSJodG1sXzU0MzZlODZlNzc5ODQ1Zjc4NjlmODUxNzk4MWVmMzM1IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5XZXN0IEZsYWdsZXI8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzhhNGMxZmM2MWU2MjQ4ZTE5Mjk5NTc1MWQ5M2U5YWIyLnNldENvbnRlbnQoaHRtbF81NDM2ZTg2ZTc3OTg0NWY3ODY5Zjg1MTc5ODFlZjMzNSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9lNzc1ZjAyYmM5ZTk0YjI2OTRmZjVlOWEwMTdjNTZkZC5iaW5kUG9wdXAocG9wdXBfOGE0YzFmYzYxZTYyNDhlMTkyOTk1NzUxZDkzZTlhYjIpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfMjQxM2MzMWIyMGZjNDYxMDk0YzQzMzMxOTYzMjIwYmYgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS44MDQwMDAwMDAwMDAwMDIsLTgwLjE5OV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJibHVlIiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiIzMxODZjYyIsCiAgImZpbGxPcGFjaXR5IjogMC43LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF8wYmU4MWU1NGQ0OWY0ZjkzODk4YzU1Yzg3Njg3ZjZjMCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9kMjNjNGEwYzFmMWE0YWQ0YTgwNTE3ODdmZjFlMWJjMSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF84NjkxZDkyZGJhNGY0NWIwOTZkMDMxM2NhY2M4NjA5NSA9ICQoJzxkaXYgaWQ9Imh0bWxfODY5MWQ5MmRiYTRmNDViMDk2ZDAzMTNjYWNjODYwOTUiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPld5bndvb2Q8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2QyM2M0YTBjMWYxYTRhZDRhODA1MTc4N2ZmMWUxYmMxLnNldENvbnRlbnQoaHRtbF84NjkxZDkyZGJhNGY0NWIwOTZkMDMxM2NhY2M4NjA5NSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8yNDEzYzMxYjIwZmM0NjEwOTRjNDMzMzE5NjMyMjBiZi5iaW5kUG9wdXAocG9wdXBfZDIzYzRhMGMxZjFhNGFkNGE4MDUxNzg3ZmYxZTFiYzEpOwoKICAgICAgICAgICAgCiAgICAgICAgCjwvc2NyaXB0Pg== onload=\"this.contentDocument.open();this.contentDocument.write(atob(this.getAttribute('data-html')));this.contentDocument.close();\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>"
      ],
      "text/plain": [
       "<folium.folium.Map at 0x192b3a6edc0>"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# create map of Miami using latitude and longitude values\n",
    "map_miami = folium.Map(location=[latitude, longitude], zoom_start=12)\n",
    "\n",
    "# add markers to map\n",
    "for lat, lng, neighborhood in zip(neighborhoods['Latitude'], neighborhoods['Longitude'], neighborhoods['Neighborhood']):\n",
    "    label = '{}'.format(neighborhood)\n",
    "    label = folium.Popup(label, parse_html=True)\n",
    "    folium.CircleMarker(\n",
    "        [lat, lng],\n",
    "        radius=5,\n",
    "        popup=label,\n",
    "        color='blue',\n",
    "        fill=True,\n",
    "        fill_color='#3186cc',\n",
    "        fill_opacity=0.7,\n",
    "        parse_html=False).add_to(map_miami)  \n",
    "    \n",
    "map_miami"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Neighborhood</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>25.815</td>\n",
       "      <td>-80.224</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arts &amp; Entertainment District</td>\n",
       "      <td>25.799</td>\n",
       "      <td>-80.190</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Brickell</td>\n",
       "      <td>25.758</td>\n",
       "      <td>-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Buena Vista</td>\n",
       "      <td>25.813</td>\n",
       "      <td>-80.192</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Coconut Grove</td>\n",
       "      <td>25.712</td>\n",
       "      <td>-80.257</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Coral Way</td>\n",
       "      <td>25.750</td>\n",
       "      <td>-80.283</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Design District</td>\n",
       "      <td>25.813</td>\n",
       "      <td>-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Downtown</td>\n",
       "      <td>25.774</td>\n",
       "      <td>-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Edgewater</td>\n",
       "      <td>25.802</td>\n",
       "      <td>-80.190</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Flagami</td>\n",
       "      <td>25.762</td>\n",
       "      <td>-80.316</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Grapeland Heights</td>\n",
       "      <td>25.792</td>\n",
       "      <td>-80.258</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Liberty City</td>\n",
       "      <td>25.832</td>\n",
       "      <td>-80.225</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Little Haiti</td>\n",
       "      <td>25.824</td>\n",
       "      <td>-80.191</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Little Havana</td>\n",
       "      <td>25.773</td>\n",
       "      <td>-80.215</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Lummus Park</td>\n",
       "      <td>25.777</td>\n",
       "      <td>-80.201</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Midtown</td>\n",
       "      <td>25.807</td>\n",
       "      <td>-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Overtown</td>\n",
       "      <td>25.787</td>\n",
       "      <td>-80.201</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Park West</td>\n",
       "      <td>25.785</td>\n",
       "      <td>-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>The Roads</td>\n",
       "      <td>25.756</td>\n",
       "      <td>-80.207</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Upper Eastside</td>\n",
       "      <td>25.830</td>\n",
       "      <td>-80.183</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Venetian Islands</td>\n",
       "      <td>25.791</td>\n",
       "      <td>-80.161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Virginia Key</td>\n",
       "      <td>25.736</td>\n",
       "      <td>-80.155</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>West Flagler</td>\n",
       "      <td>25.775</td>\n",
       "      <td>-80.243</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Wynwood</td>\n",
       "      <td>25.804</td>\n",
       "      <td>-80.199</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Neighborhood  Latitude  Longitude\n",
       "0                      Allapattah    25.815    -80.224\n",
       "1   Arts & Entertainment District    25.799    -80.190\n",
       "2                        Brickell    25.758    -80.193\n",
       "3                     Buena Vista    25.813    -80.192\n",
       "4                   Coconut Grove    25.712    -80.257\n",
       "5                       Coral Way    25.750    -80.283\n",
       "6                 Design District    25.813    -80.193\n",
       "7                        Downtown    25.774    -80.193\n",
       "8                       Edgewater    25.802    -80.190\n",
       "9                         Flagami    25.762    -80.316\n",
       "10              Grapeland Heights    25.792    -80.258\n",
       "12                   Liberty City    25.832    -80.225\n",
       "13                   Little Haiti    25.824    -80.191\n",
       "14                  Little Havana    25.773    -80.215\n",
       "15                    Lummus Park    25.777    -80.201\n",
       "16                        Midtown    25.807    -80.193\n",
       "17                       Overtown    25.787    -80.201\n",
       "18                      Park West    25.785    -80.193\n",
       "19                      The Roads    25.756    -80.207\n",
       "20                 Upper Eastside    25.830    -80.183\n",
       "21               Venetian Islands    25.791    -80.161\n",
       "22                   Virginia Key    25.736    -80.155\n",
       "23                   West Flagler    25.775    -80.243\n",
       "24                        Wynwood    25.804    -80.199"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#neighborhoods.info()\n",
    "neighborhoods.head(40)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Next, we are going to start utilizing the Foursquare API to explore the neighborhoods and segment them.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Define Foursquare Credentials and Version\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Your credentails:\n",
      "CLIENT_ID: \n",
      "CLIENT_SECRET:\n"
     ]
    }
   ],
   "source": [
    "CLIENT_ID = '' # your Foursquare ID\n",
    "CLIENT_SECRET = '' # your Foursquare Secret\n",
    "VERSION = '20180605' # Foursquare API version\n",
    "LIMIT = 100 # A default Foursquare API limit value\n",
    "\n",
    "print('Your credentails:')\n",
    "print('CLIENT_ID: ' + CLIENT_ID)\n",
    "print('CLIENT_SECRET:' + CLIENT_SECRET)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Let's explore the first neighborhood in our dataframe.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Get the first neighborhood's name.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Allapattah'"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "neighborhoods.loc[0, 'Neighborhood']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Get the neighborhood's latitude and longitude values.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Latitude and longitude values of Allapattah are 25.815, -80.224.\n"
     ]
    }
   ],
   "source": [
    "neighborhood_latitude = round(neighborhoods.loc[0, 'Latitude'],3) # neighborhood latitude value\n",
    "neighborhood_longitude = round(neighborhoods.loc[0, 'Longitude'],3) # neighborhood longitude value\n",
    "\n",
    "neighborhood_name = neighborhoods.loc[0, 'Neighborhood'] # neighborhood name\n",
    "\n",
    "print('Latitude and longitude values of {} are {}, {}.'.format(neighborhood_name, \n",
    "                                                               neighborhood_latitude, \n",
    "                                                               neighborhood_longitude))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Now, let's get the top 100 venues that are in Allapattah within a radius of 1500 meters.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "First, let's create the GET request URL. Name your URL **url**.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'https://api.foursquare.com/v2/venues/explore?&client_id=QBDVQDIAMM0I0Q3QVMOL31R3XQRX0BPV5OOSEIILFNFXDGEJ&client_secret=JPGFSDCCFB1POQDRPVMJOCGOBWJQOLEGD24GUTMDAI3SPM1N&v=20180605&ll=25.815,-80.224&categoryId=4bf58dd8d48988d13b941735&radius=1500&limit=100'"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "LIMIT = 100 # limit of number of venues returned by Foursquare API\n",
    "radius = 1500 # define radius\n",
    "categoryId='4bf58dd8d48988d13b941735' # category for school\n",
    "# create URL\n",
    "url = 'https://api.foursquare.com/v2/venues/explore?&client_id={}&client_secret={}&v={}&ll={},{}&categoryId={}&radius={}&limit={}'.format(\n",
    "    CLIENT_ID, \n",
    "    CLIENT_SECRET, \n",
    "    VERSION, \n",
    "    neighborhood_latitude, \n",
    "    neighborhood_longitude, \n",
    "    categoryId,\n",
    "    radius, \n",
    "    LIMIT)\n",
    "\n",
    "\n",
    "url # display URL"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Send the GET request and examine the resutls\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'meta': {'code': 200, 'requestId': '5f93e6eea106903c946369f2'},\n",
       " 'response': {'headerLocation': 'Model City',\n",
       "  'headerFullLocation': 'Model City, Miami',\n",
       "  'headerLocationGranularity': 'neighborhood',\n",
       "  'query': 'school',\n",
       "  'totalResults': 7,\n",
       "  'suggestedBounds': {'ne': {'lat': 25.828500013500015,\n",
       "    'lng': -80.2090313978883},\n",
       "   'sw': {'lat': 25.801499986499987, 'lng': -80.23896860211171}},\n",
       "  'groups': [{'type': 'Recommended Places',\n",
       "    'name': 'recommended',\n",
       "    'items': [{'reasons': {'count': 0,\n",
       "       'items': [{'summary': 'This spot is popular',\n",
       "         'type': 'general',\n",
       "         'reasonName': 'globalInteractionReason'}]},\n",
       "      'venue': {'id': '4c3a53500a71c9b6d01844c9',\n",
       "       'name': 'Miami Jackson Senior High School',\n",
       "       'location': {'address': '1751 NW 36th St',\n",
       "        'lat': 25.809993097862588,\n",
       "        'lng': -80.22548431119802,\n",
       "        'labeledLatLngs': [{'label': 'display',\n",
       "          'lat': 25.809993097862588,\n",
       "          'lng': -80.22548431119802},\n",
       "         {'label': 'entrance', 'lat': 25.810669, 'lng': -80.225299}],\n",
       "        'distance': 576,\n",
       "        'postalCode': '33142',\n",
       "        'cc': 'US',\n",
       "        'city': 'Miami',\n",
       "        'state': 'FL',\n",
       "        'country': 'United States',\n",
       "        'formattedAddress': ['1751 NW 36th St',\n",
       "         'Miami, FL 33142',\n",
       "         'United States']},\n",
       "       'categories': [{'id': '4bf58dd8d48988d13d941735',\n",
       "         'name': 'High School',\n",
       "         'pluralName': 'High Schools',\n",
       "         'shortName': 'High School',\n",
       "         'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/building/school_',\n",
       "          'suffix': '.png'},\n",
       "         'primary': True}],\n",
       "       'photos': {'count': 0, 'groups': []}},\n",
       "      'referralId': 'e-0-4c3a53500a71c9b6d01844c9-0'},\n",
       "     {'reasons': {'count': 0,\n",
       "       'items': [{'summary': 'This spot is popular',\n",
       "         'type': 'general',\n",
       "         'reasonName': 'globalInteractionReason'}]},\n",
       "      'venue': {'id': '4d345be6c6cba35dd2c7327a',\n",
       "       'name': 'Allapattah Middle School',\n",
       "       'location': {'address': '1331 NW 46th St',\n",
       "        'lat': 25.817823,\n",
       "        'lng': -80.21896600000001,\n",
       "        'labeledLatLngs': [{'label': 'display',\n",
       "          'lat': 25.817823,\n",
       "          'lng': -80.21896600000001},\n",
       "         {'label': 'entrance', 'lat': 25.817372, 'lng': -80.219169}],\n",
       "        'distance': 594,\n",
       "        'postalCode': '33142',\n",
       "        'cc': 'US',\n",
       "        'city': 'Miami',\n",
       "        'state': 'FL',\n",
       "        'country': 'United States',\n",
       "        'formattedAddress': ['1331 NW 46th St',\n",
       "         'Miami, FL 33142',\n",
       "         'United States']},\n",
       "       'categories': [{'id': '4bf58dd8d48988d198941735',\n",
       "         'name': 'College Academic Building',\n",
       "         'pluralName': 'College Academic Buildings',\n",
       "         'shortName': 'Academic Building',\n",
       "         'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/education/academicbuilding_',\n",
       "          'suffix': '.png'},\n",
       "         'primary': True}],\n",
       "       'photos': {'count': 0, 'groups': []}},\n",
       "      'referralId': 'e-0-4d345be6c6cba35dd2c7327a-1'},\n",
       "     {'reasons': {'count': 0,\n",
       "       'items': [{'summary': 'This spot is popular',\n",
       "         'type': 'general',\n",
       "         'reasonName': 'globalInteractionReason'}]},\n",
       "      'venue': {'id': '4f1d7c50e4b091897bd30b48',\n",
       "       'name': 'Lenora Braynon Smith Elementary School',\n",
       "       'location': {'lat': 25.818558910474266,\n",
       "        'lng': -80.21723811700872,\n",
       "        'labeledLatLngs': [{'label': 'display',\n",
       "          'lat': 25.818558910474266,\n",
       "          'lng': -80.21723811700872}],\n",
       "        'distance': 784,\n",
       "        'postalCode': '33127',\n",
       "        'cc': 'US',\n",
       "        'city': 'Miami',\n",
       "        'state': 'FL',\n",
       "        'country': 'United States',\n",
       "        'formattedAddress': ['Miami, FL 33127', 'United States']},\n",
       "       'categories': [{'id': '4f4533804b9074f6e4fb0105',\n",
       "         'name': 'Elementary School',\n",
       "         'pluralName': 'Elementary Schools',\n",
       "         'shortName': 'Elementary School',\n",
       "         'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/building/school_',\n",
       "          'suffix': '.png'},\n",
       "         'primary': True}],\n",
       "       'photos': {'count': 0, 'groups': []}},\n",
       "      'referralId': 'e-0-4f1d7c50e4b091897bd30b48-2'},\n",
       "     {'reasons': {'count': 0,\n",
       "       'items': [{'summary': 'This spot is popular',\n",
       "         'type': 'general',\n",
       "         'reasonName': 'globalInteractionReason'}]},\n",
       "      'venue': {'id': '4d5452f016a6b60c757f3ef8',\n",
       "       'name': 'Brownsville Middle School',\n",
       "       'location': {'address': '4899 NW 24th Ave',\n",
       "        'lat': 25.819448471069336,\n",
       "        'lng': -80.23554229736328,\n",
       "        'labeledLatLngs': [{'label': 'display',\n",
       "          'lat': 25.819448471069336,\n",
       "          'lng': -80.23554229736328}],\n",
       "        'distance': 1258,\n",
       "        'postalCode': '33142',\n",
       "        'cc': 'US',\n",
       "        'city': 'Miami',\n",
       "        'state': 'FL',\n",
       "        'country': 'United States',\n",
       "        'formattedAddress': ['4899 NW 24th Ave',\n",
       "         'Miami, FL 33142',\n",
       "         'United States']},\n",
       "       'categories': [{'id': '4f4533814b9074f6e4fb0106',\n",
       "         'name': 'Middle School',\n",
       "         'pluralName': 'Middle Schools',\n",
       "         'shortName': 'Middle School',\n",
       "         'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/building/school_',\n",
       "          'suffix': '.png'},\n",
       "         'primary': True}],\n",
       "       'photos': {'count': 0, 'groups': []}},\n",
       "      'referralId': 'e-0-4d5452f016a6b60c757f3ef8-3'},\n",
       "     {'reasons': {'count': 0,\n",
       "       'items': [{'summary': 'This spot is popular',\n",
       "         'type': 'general',\n",
       "         'reasonName': 'globalInteractionReason'}]},\n",
       "      'venue': {'id': '4ed779decc21a6423f592c5f',\n",
       "       'name': 'Earlington Heights Elementary',\n",
       "       'location': {'lat': 25.818344063480158,\n",
       "        'lng': -80.23271677446496,\n",
       "        'labeledLatLngs': [{'label': 'display',\n",
       "          'lat': 25.818344063480158,\n",
       "          'lng': -80.23271677446496}],\n",
       "        'distance': 949,\n",
       "        'postalCode': '33142',\n",
       "        'cc': 'US',\n",
       "        'state': 'Florida',\n",
       "        'country': 'United States',\n",
       "        'formattedAddress': ['FL 33142', 'United States']},\n",
       "       'categories': [{'id': '4f4533804b9074f6e4fb0105',\n",
       "         'name': 'Elementary School',\n",
       "         'pluralName': 'Elementary Schools',\n",
       "         'shortName': 'Elementary School',\n",
       "         'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/building/school_',\n",
       "          'suffix': '.png'},\n",
       "         'primary': True}],\n",
       "       'photos': {'count': 0, 'groups': []}},\n",
       "      'referralId': 'e-0-4ed779decc21a6423f592c5f-4'},\n",
       "     {'reasons': {'count': 0,\n",
       "       'items': [{'summary': 'This spot is popular',\n",
       "         'type': 'general',\n",
       "         'reasonName': 'globalInteractionReason'}]},\n",
       "      'venue': {'id': '4f6c8320e4b03b575b45a8a0',\n",
       "       'name': 'Maya Angelou Elementary',\n",
       "       'location': {'lat': 25.805198999999998,\n",
       "        'lng': -80.226761,\n",
       "        'labeledLatLngs': [{'label': 'display',\n",
       "          'lat': 25.805198999999998,\n",
       "          'lng': -80.226761},\n",
       "         {'label': 'entrance', 'lat': 25.805413, 'lng': -80.226823}],\n",
       "        'distance': 1125,\n",
       "        'postalCode': '33142',\n",
       "        'cc': 'US',\n",
       "        'city': 'Miami',\n",
       "        'state': 'FL',\n",
       "        'country': 'United States',\n",
       "        'formattedAddress': ['Miami, FL 33142', 'United States']},\n",
       "       'categories': [{'id': '4f4533804b9074f6e4fb0105',\n",
       "         'name': 'Elementary School',\n",
       "         'pluralName': 'Elementary Schools',\n",
       "         'shortName': 'Elementary School',\n",
       "         'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/building/school_',\n",
       "          'suffix': '.png'},\n",
       "         'primary': True}],\n",
       "       'photos': {'count': 0, 'groups': []}},\n",
       "      'referralId': 'e-0-4f6c8320e4b03b575b45a8a0-5'},\n",
       "     {'reasons': {'count': 0,\n",
       "       'items': [{'summary': 'This spot is popular',\n",
       "         'type': 'general',\n",
       "         'reasonName': 'globalInteractionReason'}]},\n",
       "      'venue': {'id': '4f1d6903e4b0850c86300201',\n",
       "       'name': 'Olinda Elementary School',\n",
       "       'location': {'address': 'NW 22 St',\n",
       "        'lat': 25.826091336708036,\n",
       "        'lng': -80.23131716656441,\n",
       "        'labeledLatLngs': [{'label': 'display',\n",
       "          'lat': 25.826091336708036,\n",
       "          'lng': -80.23131716656441}],\n",
       "        'distance': 1435,\n",
       "        'postalCode': '33142',\n",
       "        'cc': 'US',\n",
       "        'city': 'Miami',\n",
       "        'state': 'FL',\n",
       "        'country': 'United States',\n",
       "        'formattedAddress': ['NW 22 St', 'Miami, FL 33142', 'United States']},\n",
       "       'categories': [{'id': '4f4533804b9074f6e4fb0105',\n",
       "         'name': 'Elementary School',\n",
       "         'pluralName': 'Elementary Schools',\n",
       "         'shortName': 'Elementary School',\n",
       "         'icon': {'prefix': 'https://ss3.4sqi.net/img/categories_v2/building/school_',\n",
       "          'suffix': '.png'},\n",
       "         'primary': True}],\n",
       "       'photos': {'count': 0, 'groups': []}},\n",
       "      'referralId': 'e-0-4f1d6903e4b0850c86300201-6'}]}]}}"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "results = requests.get(url).json()\n",
    "results"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "From the Foursquare lab in the previous module, we know that all the information is in the _items_ key. Before we proceed, let's borrow the **get_category_type** function from the Foursquare lab.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "# function that extracts the category of the venue\n",
    "def get_category_type(row):\n",
    "    try:\n",
    "        categories_list = row['categories']\n",
    "    except:\n",
    "        categories_list = row['venue.categories']\n",
    "        \n",
    "    if len(categories_list) == 0:\n",
    "        return None\n",
    "    else:\n",
    "        return categories_list[0]['name']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now we are ready to clean the json and structure it into a _pandas_ dataframe.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-24-561c05f0fdd1>:3: FutureWarning: pandas.io.json.json_normalize is deprecated, use pandas.json_normalize instead\n",
      "  nearby_venues = json_normalize(venues) # flatten JSON\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>categories</th>\n",
       "      <th>lat</th>\n",
       "      <th>lng</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Miami Jackson Senior High School</td>\n",
       "      <td>High School</td>\n",
       "      <td>25.809993</td>\n",
       "      <td>-80.225484</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Allapattah Middle School</td>\n",
       "      <td>College Academic Building</td>\n",
       "      <td>25.817823</td>\n",
       "      <td>-80.218966</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Lenora Braynon Smith Elementary School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>25.818559</td>\n",
       "      <td>-80.217238</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Brownsville Middle School</td>\n",
       "      <td>Middle School</td>\n",
       "      <td>25.819448</td>\n",
       "      <td>-80.235542</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Earlington Heights Elementary</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>25.818344</td>\n",
       "      <td>-80.232717</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                     name                 categories  \\\n",
       "0        Miami Jackson Senior High School                High School   \n",
       "1                Allapattah Middle School  College Academic Building   \n",
       "2  Lenora Braynon Smith Elementary School          Elementary School   \n",
       "3               Brownsville Middle School              Middle School   \n",
       "4           Earlington Heights Elementary          Elementary School   \n",
       "\n",
       "         lat        lng  \n",
       "0  25.809993 -80.225484  \n",
       "1  25.817823 -80.218966  \n",
       "2  25.818559 -80.217238  \n",
       "3  25.819448 -80.235542  \n",
       "4  25.818344 -80.232717  "
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "venues = results['response']['groups'][0]['items']\n",
    "    \n",
    "nearby_venues = json_normalize(venues) # flatten JSON\n",
    "\n",
    "# filter columns\n",
    "filtered_columns = ['venue.name', 'venue.categories', 'venue.location.lat', 'venue.location.lng']\n",
    "nearby_venues =nearby_venues.loc[:, filtered_columns]\n",
    "\n",
    "# filter the category for each row\n",
    "nearby_venues['venue.categories'] = nearby_venues.apply(get_category_type, axis=1)\n",
    "\n",
    "# clean columns\n",
    "nearby_venues.columns = [col.split(\".\")[-1] for col in nearby_venues.columns]\n",
    "\n",
    "nearby_venues.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "And how many venues were returned by Foursquare?\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "7 venues were returned by Foursquare.\n"
     ]
    }
   ],
   "source": [
    "print('{} venues were returned by Foursquare.'.format(nearby_venues.shape[0]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Methodology <a name=\"methodology\"></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In this project we will direct our efforts on detecting areas of Miami that have high educational institute density, \n",
    "\n",
    "In first step we have collected the required **data: location and type (category) of every educational institutes in  Miami ** (Allapattah). We have also **identified educational institute types** (according to Foursquare categorization).\n",
    "\n",
    "Second step in our analysis will be calculation and exploration of '**educational institute density**' across different areas of Miami - we will use **heatmaps** to identify a few promising areas with high number of educational institutes in general.\n",
    "\n",
    "We will present map of all neighborhoods with its total educational institute count of those locations to identify / neighborhoods which should be a optimal potential location for stakeholders."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Analysis <a name=\"analysis\"></a>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's perform some basic explanatory data analysis and derive some additional info from our raw data. Lets Explore each Neighborhoods in Miami"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2. Explore Neighborhoods in Miami\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Let's create a function to repeat the same process to all the neighborhoods in Miami\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "def getNearbyVenues(names, latitudes, longitudes, radius=1500):\n",
    "    \n",
    "    venues_list=[]\n",
    "    for name, lat, lng in zip(names, latitudes, longitudes):\n",
    "        print(name)\n",
    "            \n",
    "        # create the API request URL\n",
    "        url = 'https://api.foursquare.com/v2/venues/explore?&client_id={}&client_secret={}&v={}&ll={},{}&radius={}&limit={}&categoryId={}'.format(\n",
    "            CLIENT_ID, \n",
    "            CLIENT_SECRET, \n",
    "            VERSION, \n",
    "            lat, \n",
    "            lng, \n",
    "            radius, \n",
    "            LIMIT,\n",
    "            categoryId\n",
    "        )\n",
    "            \n",
    "        # make the GET request\n",
    "        results = requests.get(url).json()[\"response\"]['groups'][0]['items']\n",
    "        \n",
    "        # return only relevant information for each nearby venue\n",
    "        venues_list.append([(\n",
    "            name, \n",
    "            lat, \n",
    "            lng, \n",
    "            v['venue']['name'], \n",
    "            v['venue']['location']['lat'], \n",
    "            v['venue']['location']['lng'],  \n",
    "            v['venue']['categories'][0]['name']) for v in results])\n",
    "\n",
    "    nearby_venues = pd.DataFrame([item for venue_list in venues_list for item in venue_list])\n",
    "    nearby_venues.columns = ['Neighborhood', \n",
    "                  'Neighborhood Latitude', \n",
    "                  'Neighborhood Longitude', \n",
    "                  'Venue', \n",
    "                  'Venue Latitude', \n",
    "                  'Venue Longitude', \n",
    "                  'Venue Category']\n",
    "    \n",
    "    return(nearby_venues)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Now write the code to run the above function on each neighborhood and create a new dataframe called miami_venues.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Neighborhood</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>25.815</td>\n",
       "      <td>-80.224</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arts &amp; Entertainment District</td>\n",
       "      <td>25.799</td>\n",
       "      <td>-80.190</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Brickell</td>\n",
       "      <td>25.758</td>\n",
       "      <td>-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Buena Vista</td>\n",
       "      <td>25.813</td>\n",
       "      <td>-80.192</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Coconut Grove</td>\n",
       "      <td>25.712</td>\n",
       "      <td>-80.257</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Coral Way</td>\n",
       "      <td>25.750</td>\n",
       "      <td>-80.283</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Design District</td>\n",
       "      <td>25.813</td>\n",
       "      <td>-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Downtown</td>\n",
       "      <td>25.774</td>\n",
       "      <td>-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Edgewater</td>\n",
       "      <td>25.802</td>\n",
       "      <td>-80.190</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Flagami</td>\n",
       "      <td>25.762</td>\n",
       "      <td>-80.316</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Grapeland Heights</td>\n",
       "      <td>25.792</td>\n",
       "      <td>-80.258</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Liberty City</td>\n",
       "      <td>25.832</td>\n",
       "      <td>-80.225</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Little Haiti</td>\n",
       "      <td>25.824</td>\n",
       "      <td>-80.191</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Little Havana</td>\n",
       "      <td>25.773</td>\n",
       "      <td>-80.215</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Lummus Park</td>\n",
       "      <td>25.777</td>\n",
       "      <td>-80.201</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Midtown</td>\n",
       "      <td>25.807</td>\n",
       "      <td>-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Overtown</td>\n",
       "      <td>25.787</td>\n",
       "      <td>-80.201</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Park West</td>\n",
       "      <td>25.785</td>\n",
       "      <td>-80.193</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>The Roads</td>\n",
       "      <td>25.756</td>\n",
       "      <td>-80.207</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Upper Eastside</td>\n",
       "      <td>25.830</td>\n",
       "      <td>-80.183</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Venetian Islands</td>\n",
       "      <td>25.791</td>\n",
       "      <td>-80.161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Virginia Key</td>\n",
       "      <td>25.736</td>\n",
       "      <td>-80.155</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>West Flagler</td>\n",
       "      <td>25.775</td>\n",
       "      <td>-80.243</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Wynwood</td>\n",
       "      <td>25.804</td>\n",
       "      <td>-80.199</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Neighborhood  Latitude  Longitude\n",
       "0                      Allapattah    25.815    -80.224\n",
       "1   Arts & Entertainment District    25.799    -80.190\n",
       "2                        Brickell    25.758    -80.193\n",
       "3                     Buena Vista    25.813    -80.192\n",
       "4                   Coconut Grove    25.712    -80.257\n",
       "5                       Coral Way    25.750    -80.283\n",
       "6                 Design District    25.813    -80.193\n",
       "7                        Downtown    25.774    -80.193\n",
       "8                       Edgewater    25.802    -80.190\n",
       "9                         Flagami    25.762    -80.316\n",
       "10              Grapeland Heights    25.792    -80.258\n",
       "12                   Liberty City    25.832    -80.225\n",
       "13                   Little Haiti    25.824    -80.191\n",
       "14                  Little Havana    25.773    -80.215\n",
       "15                    Lummus Park    25.777    -80.201\n",
       "16                        Midtown    25.807    -80.193\n",
       "17                       Overtown    25.787    -80.201\n",
       "18                      Park West    25.785    -80.193\n",
       "19                      The Roads    25.756    -80.207\n",
       "20                 Upper Eastside    25.830    -80.183\n",
       "21               Venetian Islands    25.791    -80.161\n",
       "22                   Virginia Key    25.736    -80.155\n",
       "23                   West Flagler    25.775    -80.243\n",
       "24                        Wynwood    25.804    -80.199"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "neighborhoods"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Allapattah\n",
      "Arts & Entertainment District\n",
      "Brickell\n",
      "Buena Vista\n",
      "Coconut Grove\n",
      "Coral Way\n",
      "Design District\n",
      "Downtown\n",
      "Edgewater\n",
      "Flagami\n",
      "Grapeland Heights\n",
      "Liberty City\n",
      "Little Haiti\n",
      "Little Havana\n",
      "Lummus Park\n",
      "Midtown\n",
      "Overtown\n",
      "Park West\n",
      "The Roads\n",
      "Upper Eastside\n",
      "Venetian Islands\n",
      "Virginia Key\n",
      "West Flagler\n",
      "Wynwood\n"
     ]
    }
   ],
   "source": [
    "miami_venues = getNearbyVenues(names=neighborhoods['Neighborhood'],\n",
    "                                   latitudes=neighborhoods['Latitude'],\n",
    "                                   longitudes=neighborhoods['Longitude'])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Let's check the size of the resulting dataframe\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(342, 7)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Neighborhood</th>\n",
       "      <th>Neighborhood Latitude</th>\n",
       "      <th>Neighborhood Longitude</th>\n",
       "      <th>Venue</th>\n",
       "      <th>Venue Latitude</th>\n",
       "      <th>Venue Longitude</th>\n",
       "      <th>Venue Category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>25.815</td>\n",
       "      <td>-80.224</td>\n",
       "      <td>Miami Jackson Senior High School</td>\n",
       "      <td>25.809993</td>\n",
       "      <td>-80.225484</td>\n",
       "      <td>High School</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>25.815</td>\n",
       "      <td>-80.224</td>\n",
       "      <td>Allapattah Middle School</td>\n",
       "      <td>25.817823</td>\n",
       "      <td>-80.218966</td>\n",
       "      <td>College Academic Building</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>25.815</td>\n",
       "      <td>-80.224</td>\n",
       "      <td>Lenora Braynon Smith Elementary School</td>\n",
       "      <td>25.818559</td>\n",
       "      <td>-80.217238</td>\n",
       "      <td>Elementary School</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>25.815</td>\n",
       "      <td>-80.224</td>\n",
       "      <td>Brownsville Middle School</td>\n",
       "      <td>25.819448</td>\n",
       "      <td>-80.235542</td>\n",
       "      <td>Middle School</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>25.815</td>\n",
       "      <td>-80.224</td>\n",
       "      <td>Earlington Heights Elementary</td>\n",
       "      <td>25.818344</td>\n",
       "      <td>-80.232717</td>\n",
       "      <td>Elementary School</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Neighborhood  Neighborhood Latitude  Neighborhood Longitude  \\\n",
       "0   Allapattah                 25.815                 -80.224   \n",
       "1   Allapattah                 25.815                 -80.224   \n",
       "2   Allapattah                 25.815                 -80.224   \n",
       "3   Allapattah                 25.815                 -80.224   \n",
       "4   Allapattah                 25.815                 -80.224   \n",
       "\n",
       "                                    Venue  Venue Latitude  Venue Longitude  \\\n",
       "0        Miami Jackson Senior High School       25.809993       -80.225484   \n",
       "1                Allapattah Middle School       25.817823       -80.218966   \n",
       "2  Lenora Braynon Smith Elementary School       25.818559       -80.217238   \n",
       "3               Brownsville Middle School       25.819448       -80.235542   \n",
       "4           Earlington Heights Elementary       25.818344       -80.232717   \n",
       "\n",
       "              Venue Category  \n",
       "0                High School  \n",
       "1  College Academic Building  \n",
       "2          Elementary School  \n",
       "3              Middle School  \n",
       "4          Elementary School  "
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(miami_venues.shape)\n",
    "miami_venues.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's check how many venues were returned for each neighborhood\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "dfGroup = miami_venues.groupby('Neighborhood').count()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>NumberOfInstitutes</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Neighborhood</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Allapattah</th>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Arts &amp; Entertainment District</th>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Brickell</th>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Buena Vista</th>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Coconut Grove</th>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Coral Way</th>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Design District</th>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Downtown</th>\n",
       "      <td>37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Edgewater</th>\n",
       "      <td>24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Flagami</th>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Grapeland Heights</th>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Liberty City</th>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Little Haiti</th>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Little Havana</th>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Lummus Park</th>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Midtown</th>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Overtown</th>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Park West</th>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>The Roads</th>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Upper Eastside</th>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Venetian Islands</th>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Virginia Key</th>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>West Flagler</th>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Wynwood</th>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                               NumberOfInstitutes\n",
       "Neighborhood                                     \n",
       "Allapattah                                      7\n",
       "Arts & Entertainment District                  20\n",
       "Brickell                                       25\n",
       "Buena Vista                                    17\n",
       "Coconut Grove                                   5\n",
       "Coral Way                                       6\n",
       "Design District                                18\n",
       "Downtown                                       37\n",
       "Edgewater                                      24\n",
       "Flagami                                         9\n",
       "Grapeland Heights                               2\n",
       "Liberty City                                    6\n",
       "Little Haiti                                   10\n",
       "Little Havana                                  13\n",
       "Lummus Park                                    28\n",
       "Midtown                                        21\n",
       "Overtown                                       17\n",
       "Park West                                      19\n",
       "The Roads                                      13\n",
       "Upper Eastside                                  4\n",
       "Venetian Islands                                1\n",
       "Virginia Key                                    2\n",
       "West Flagler                                   12\n",
       "Wynwood                                        26"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfGroup.drop([\"Neighborhood Latitude\",\"Neighborhood Longitude\",\"Venue Latitude\",\"Venue Longitude\",\"Venue Category\"], axis = 1, inplace=True) \n",
    "dfGroup.rename(columns={'Venue': 'NumberOfInstitutes'}, inplace=True)\n",
    "dfGroup\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Let's find out how many unique categories can be curated from all the returned venues\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are 28 uniques categories.\n"
     ]
    }
   ],
   "source": [
    "print('There are {} uniques categories.'.format(len(miami_venues['Venue Category'].unique())))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='item3'></a>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3. Analyze Each Neighborhood\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Neighborhood</th>\n",
       "      <th>Adult Education Center</th>\n",
       "      <th>Art Gallery</th>\n",
       "      <th>Business Service</th>\n",
       "      <th>Church</th>\n",
       "      <th>College Academic Building</th>\n",
       "      <th>College Arts Building</th>\n",
       "      <th>College Lab</th>\n",
       "      <th>Daycare</th>\n",
       "      <th>Driving School</th>\n",
       "      <th>Elementary School</th>\n",
       "      <th>General College &amp; University</th>\n",
       "      <th>Golf Course</th>\n",
       "      <th>High School</th>\n",
       "      <th>Language School</th>\n",
       "      <th>Middle School</th>\n",
       "      <th>Miscellaneous Shop</th>\n",
       "      <th>Music School</th>\n",
       "      <th>Nursery School</th>\n",
       "      <th>Playground</th>\n",
       "      <th>Preschool</th>\n",
       "      <th>Private School</th>\n",
       "      <th>Religious School</th>\n",
       "      <th>School</th>\n",
       "      <th>Student Center</th>\n",
       "      <th>Swim School</th>\n",
       "      <th>Trade School</th>\n",
       "      <th>University</th>\n",
       "      <th>Zoo</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Neighborhood  Adult Education Center  Art Gallery  Business Service  Church  \\\n",
       "0   Allapattah                       0            0                 0       0   \n",
       "1   Allapattah                       0            0                 0       0   \n",
       "2   Allapattah                       0            0                 0       0   \n",
       "3   Allapattah                       0            0                 0       0   \n",
       "4   Allapattah                       0            0                 0       0   \n",
       "\n",
       "   College Academic Building  College Arts Building  College Lab  Daycare  \\\n",
       "0                          0                      0            0        0   \n",
       "1                          1                      0            0        0   \n",
       "2                          0                      0            0        0   \n",
       "3                          0                      0            0        0   \n",
       "4                          0                      0            0        0   \n",
       "\n",
       "   Driving School  Elementary School  General College & University  \\\n",
       "0               0                  0                             0   \n",
       "1               0                  0                             0   \n",
       "2               0                  1                             0   \n",
       "3               0                  0                             0   \n",
       "4               0                  1                             0   \n",
       "\n",
       "   Golf Course  High School  Language School  Middle School  \\\n",
       "0            0            1                0              0   \n",
       "1            0            0                0              0   \n",
       "2            0            0                0              0   \n",
       "3            0            0                0              1   \n",
       "4            0            0                0              0   \n",
       "\n",
       "   Miscellaneous Shop  Music School  Nursery School  Playground  Preschool  \\\n",
       "0                   0             0               0           0          0   \n",
       "1                   0             0               0           0          0   \n",
       "2                   0             0               0           0          0   \n",
       "3                   0             0               0           0          0   \n",
       "4                   0             0               0           0          0   \n",
       "\n",
       "   Private School  Religious School  School  Student Center  Swim School  \\\n",
       "0               0                 0       0               0            0   \n",
       "1               0                 0       0               0            0   \n",
       "2               0                 0       0               0            0   \n",
       "3               0                 0       0               0            0   \n",
       "4               0                 0       0               0            0   \n",
       "\n",
       "   Trade School  University  Zoo  \n",
       "0             0           0    0  \n",
       "1             0           0    0  \n",
       "2             0           0    0  \n",
       "3             0           0    0  \n",
       "4             0           0    0  "
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# one hot encoding\n",
    "miami_onehot = pd.get_dummies(miami_venues[['Venue Category']], prefix=\"\", prefix_sep=\"\")\n",
    "\n",
    "# add neighborhood column back to dataframe\n",
    "miami_onehot['Neighborhood'] = miami_venues['Neighborhood'] \n",
    "\n",
    "# move neighborhood column to the first column\n",
    "fixed_columns = [miami_onehot.columns[-1]] + list(miami_onehot.columns[:-1])\n",
    "miami_onehot = miami_onehot[fixed_columns]\n",
    "\n",
    "miami_onehot.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "And let's examine the new dataframe size.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(342, 29)"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "miami_onehot.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Next, let's group rows by neighborhood and by taking the mean of the frequency of occurrence of each category\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Neighborhood</th>\n",
       "      <th>Adult Education Center</th>\n",
       "      <th>Art Gallery</th>\n",
       "      <th>Business Service</th>\n",
       "      <th>Church</th>\n",
       "      <th>College Academic Building</th>\n",
       "      <th>College Arts Building</th>\n",
       "      <th>College Lab</th>\n",
       "      <th>Daycare</th>\n",
       "      <th>Driving School</th>\n",
       "      <th>Elementary School</th>\n",
       "      <th>General College &amp; University</th>\n",
       "      <th>Golf Course</th>\n",
       "      <th>High School</th>\n",
       "      <th>Language School</th>\n",
       "      <th>Middle School</th>\n",
       "      <th>Miscellaneous Shop</th>\n",
       "      <th>Music School</th>\n",
       "      <th>Nursery School</th>\n",
       "      <th>Playground</th>\n",
       "      <th>Preschool</th>\n",
       "      <th>Private School</th>\n",
       "      <th>Religious School</th>\n",
       "      <th>School</th>\n",
       "      <th>Student Center</th>\n",
       "      <th>Swim School</th>\n",
       "      <th>Trade School</th>\n",
       "      <th>University</th>\n",
       "      <th>Zoo</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.142857</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.571429</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.142857</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.142857</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arts &amp; Entertainment District</td>\n",
       "      <td>0.050000</td>\n",
       "      <td>0.050000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.050000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.050000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Brickell</td>\n",
       "      <td>0.040000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.040000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.040000</td>\n",
       "      <td>0.040000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.120000</td>\n",
       "      <td>0.040000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.040000</td>\n",
       "      <td>0.040000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.080000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.040000</td>\n",
       "      <td>0.040000</td>\n",
       "      <td>0.040000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Buena Vista</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.058824</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.058824</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.176471</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.176471</td>\n",
       "      <td>0.058824</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.058824</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.058824</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.352941</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Coconut Grove</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.2</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Coral Way</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Design District</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.055556</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.055556</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.222222</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>0.055556</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.055556</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.055556</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Downtown</td>\n",
       "      <td>0.027027</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.027027</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.027027</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.135135</td>\n",
       "      <td>0.054054</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.027027</td>\n",
       "      <td>0.108108</td>\n",
       "      <td>0.027027</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.054054</td>\n",
       "      <td>0.027027</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.081081</td>\n",
       "      <td>0.054054</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.270270</td>\n",
       "      <td>0.027027</td>\n",
       "      <td>0.027027</td>\n",
       "      <td>0.027027</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Edgewater</td>\n",
       "      <td>0.041667</td>\n",
       "      <td>0.041667</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.041667</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.125000</td>\n",
       "      <td>0.083333</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.041667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.416667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.041667</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Flagami</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.111111</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.111111</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.111111</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.222222</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.111111</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Grapeland Heights</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Liberty City</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Little Haiti</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.200000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.100000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.300000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Little Havana</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.384615</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.076923</td>\n",
       "      <td>0.076923</td>\n",
       "      <td>0.076923</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.076923</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.076923</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.230769</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Lummus Park</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.035714</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.035714</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.178571</td>\n",
       "      <td>0.071429</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.107143</td>\n",
       "      <td>0.071429</td>\n",
       "      <td>0.035714</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.071429</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.035714</td>\n",
       "      <td>0.035714</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.321429</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Midtown</td>\n",
       "      <td>0.047619</td>\n",
       "      <td>0.047619</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.047619</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.142857</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.095238</td>\n",
       "      <td>0.047619</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.047619</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.047619</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.476190</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Overtown</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.176471</td>\n",
       "      <td>0.058824</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.176471</td>\n",
       "      <td>0.058824</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.058824</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.058824</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.352941</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.058824</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Park West</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.052632</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.157895</td>\n",
       "      <td>0.052632</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.157895</td>\n",
       "      <td>0.105263</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.421053</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.052632</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>The Roads</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.307692</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.076923</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.307692</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.307692</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Upper Eastside</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.250000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Venetian Islands</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Virginia Key</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>West Flagler</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.166667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.083333</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.083333</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Wynwood</td>\n",
       "      <td>0.038462</td>\n",
       "      <td>0.038462</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.038462</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.230769</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.076923</td>\n",
       "      <td>0.038462</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.038462</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.038462</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.461538</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Neighborhood  Adult Education Center  Art Gallery  \\\n",
       "0                      Allapattah                0.000000     0.000000   \n",
       "1   Arts & Entertainment District                0.050000     0.050000   \n",
       "2                        Brickell                0.040000     0.000000   \n",
       "3                     Buena Vista                0.000000     0.058824   \n",
       "4                   Coconut Grove                0.000000     0.000000   \n",
       "5                       Coral Way                0.000000     0.000000   \n",
       "6                 Design District                0.000000     0.055556   \n",
       "7                        Downtown                0.027027     0.000000   \n",
       "8                       Edgewater                0.041667     0.041667   \n",
       "9                         Flagami                0.000000     0.000000   \n",
       "10              Grapeland Heights                0.000000     0.000000   \n",
       "11                   Liberty City                0.000000     0.000000   \n",
       "12                   Little Haiti                0.000000     0.000000   \n",
       "13                  Little Havana                0.000000     0.000000   \n",
       "14                    Lummus Park                0.000000     0.000000   \n",
       "15                        Midtown                0.047619     0.047619   \n",
       "16                       Overtown                0.000000     0.000000   \n",
       "17                      Park West                0.000000     0.000000   \n",
       "18                      The Roads                0.000000     0.000000   \n",
       "19                 Upper Eastside                0.000000     0.000000   \n",
       "20               Venetian Islands                0.000000     0.000000   \n",
       "21                   Virginia Key                0.000000     0.000000   \n",
       "22                   West Flagler                0.000000     0.000000   \n",
       "23                        Wynwood                0.038462     0.038462   \n",
       "\n",
       "    Business Service    Church  College Academic Building  \\\n",
       "0                0.0  0.000000                   0.142857   \n",
       "1                0.0  0.000000                   0.000000   \n",
       "2                0.0  0.040000                   0.000000   \n",
       "3                0.0  0.000000                   0.000000   \n",
       "4                0.2  0.200000                   0.400000   \n",
       "5                0.0  0.000000                   0.000000   \n",
       "6                0.0  0.000000                   0.000000   \n",
       "7                0.0  0.027027                   0.000000   \n",
       "8                0.0  0.000000                   0.000000   \n",
       "9                0.0  0.000000                   0.000000   \n",
       "10               0.0  0.000000                   0.000000   \n",
       "11               0.0  0.000000                   0.000000   \n",
       "12               0.0  0.000000                   0.000000   \n",
       "13               0.0  0.000000                   0.000000   \n",
       "14               0.0  0.035714                   0.000000   \n",
       "15               0.0  0.000000                   0.000000   \n",
       "16               0.0  0.000000                   0.000000   \n",
       "17               0.0  0.000000                   0.000000   \n",
       "18               0.0  0.000000                   0.000000   \n",
       "19               0.0  0.000000                   0.000000   \n",
       "20               0.0  0.000000                   0.000000   \n",
       "21               0.0  0.000000                   0.000000   \n",
       "22               0.0  0.000000                   0.000000   \n",
       "23               0.0  0.000000                   0.000000   \n",
       "\n",
       "    College Arts Building  College Lab   Daycare  Driving School  \\\n",
       "0                0.000000          0.0  0.000000             0.0   \n",
       "1                0.000000          0.0  0.000000             0.0   \n",
       "2                0.000000          0.0  0.000000             0.0   \n",
       "3                0.058824          0.0  0.000000             0.0   \n",
       "4                0.000000          0.0  0.000000             0.0   \n",
       "5                0.000000          0.0  0.000000             0.0   \n",
       "6                0.055556          0.0  0.000000             0.0   \n",
       "7                0.000000          0.0  0.027027             0.0   \n",
       "8                0.041667          0.0  0.000000             0.0   \n",
       "9                0.000000          0.0  0.111111             0.0   \n",
       "10               0.000000          0.0  0.000000             0.5   \n",
       "11               0.000000          0.0  0.000000             0.0   \n",
       "12               0.100000          0.0  0.000000             0.0   \n",
       "13               0.000000          0.0  0.000000             0.0   \n",
       "14               0.000000          0.0  0.035714             0.0   \n",
       "15               0.047619          0.0  0.000000             0.0   \n",
       "16               0.000000          0.0  0.000000             0.0   \n",
       "17               0.000000          0.0  0.052632             0.0   \n",
       "18               0.000000          0.0  0.000000             0.0   \n",
       "19               0.000000          0.0  0.000000             0.0   \n",
       "20               0.000000          0.0  0.000000             0.0   \n",
       "21               0.000000          0.5  0.000000             0.0   \n",
       "22               0.000000          0.0  0.000000             0.0   \n",
       "23               0.038462          0.0  0.000000             0.0   \n",
       "\n",
       "    Elementary School  General College & University  Golf Course  High School  \\\n",
       "0            0.571429                      0.000000          0.0     0.142857   \n",
       "1            0.200000                      0.000000          0.0     0.100000   \n",
       "2            0.040000                      0.040000          0.0     0.000000   \n",
       "3            0.176471                      0.000000          0.0     0.176471   \n",
       "4            0.200000                      0.000000          0.0     0.000000   \n",
       "5            0.333333                      0.000000          0.0     0.000000   \n",
       "6            0.222222                      0.000000          0.0     0.166667   \n",
       "7            0.135135                      0.054054          0.0     0.027027   \n",
       "8            0.166667                      0.000000          0.0     0.125000   \n",
       "9            0.111111                      0.000000          0.0     0.000000   \n",
       "10           0.000000                      0.000000          0.5     0.000000   \n",
       "11           0.500000                      0.000000          0.0     0.166667   \n",
       "12           0.200000                      0.000000          0.0     0.200000   \n",
       "13           0.384615                      0.000000          0.0     0.076923   \n",
       "14           0.178571                      0.071429          0.0     0.107143   \n",
       "15           0.142857                      0.000000          0.0     0.095238   \n",
       "16           0.176471                      0.058824          0.0     0.176471   \n",
       "17           0.157895                      0.052632          0.0     0.157895   \n",
       "18           0.307692                      0.000000          0.0     0.000000   \n",
       "19           0.250000                      0.000000          0.0     0.250000   \n",
       "20           0.000000                      0.000000          0.0     0.000000   \n",
       "21           0.000000                      0.000000          0.0     0.500000   \n",
       "22           0.333333                      0.000000          0.0     0.166667   \n",
       "23           0.230769                      0.000000          0.0     0.076923   \n",
       "\n",
       "    Language School  Middle School  Miscellaneous Shop  Music School  \\\n",
       "0          0.000000       0.142857            0.000000      0.000000   \n",
       "1          0.100000       0.000000            0.050000      0.000000   \n",
       "2          0.120000       0.040000            0.000000      0.040000   \n",
       "3          0.058824       0.000000            0.058824      0.000000   \n",
       "4          0.000000       0.000000            0.000000      0.000000   \n",
       "5          0.000000       0.000000            0.000000      0.000000   \n",
       "6          0.055556       0.000000            0.055556      0.000000   \n",
       "7          0.108108       0.027027            0.000000      0.054054   \n",
       "8          0.083333       0.000000            0.041667      0.000000   \n",
       "9          0.000000       0.111111            0.000000      0.222222   \n",
       "10         0.000000       0.000000            0.000000      0.000000   \n",
       "11         0.000000       0.000000            0.000000      0.000000   \n",
       "12         0.000000       0.100000            0.000000      0.000000   \n",
       "13         0.076923       0.076923            0.000000      0.076923   \n",
       "14         0.071429       0.035714            0.000000      0.071429   \n",
       "15         0.047619       0.000000            0.047619      0.000000   \n",
       "16         0.058824       0.000000            0.000000      0.058824   \n",
       "17         0.105263       0.000000            0.000000      0.000000   \n",
       "18         0.000000       0.076923            0.000000      0.000000   \n",
       "19         0.000000       0.000000            0.000000      0.000000   \n",
       "20         0.000000       0.000000            0.000000      0.000000   \n",
       "21         0.000000       0.000000            0.000000      0.000000   \n",
       "22         0.000000       0.083333            0.000000      0.000000   \n",
       "23         0.038462       0.000000            0.038462      0.000000   \n",
       "\n",
       "    Nursery School  Playground  Preschool  Private School  Religious School  \\\n",
       "0         0.000000    0.000000   0.000000        0.000000          0.000000   \n",
       "1         0.000000    0.000000   0.000000        0.000000          0.000000   \n",
       "2         0.040000    0.000000   0.200000        0.080000          0.000000   \n",
       "3         0.000000    0.000000   0.058824        0.000000          0.000000   \n",
       "4         0.000000    0.000000   0.000000        0.000000          0.000000   \n",
       "5         0.166667    0.000000   0.000000        0.000000          0.000000   \n",
       "6         0.000000    0.000000   0.055556        0.000000          0.000000   \n",
       "7         0.027027    0.000000   0.081081        0.054054          0.000000   \n",
       "8         0.000000    0.000000   0.000000        0.000000          0.000000   \n",
       "9         0.000000    0.000000   0.000000        0.000000          0.000000   \n",
       "10        0.000000    0.000000   0.000000        0.000000          0.000000   \n",
       "11        0.000000    0.000000   0.000000        0.000000          0.000000   \n",
       "12        0.000000    0.000000   0.100000        0.000000          0.000000   \n",
       "13        0.000000    0.000000   0.000000        0.076923          0.000000   \n",
       "14        0.000000    0.000000   0.035714        0.035714          0.000000   \n",
       "15        0.000000    0.000000   0.047619        0.000000          0.000000   \n",
       "16        0.000000    0.058824   0.000000        0.000000          0.000000   \n",
       "17        0.000000    0.000000   0.000000        0.000000          0.000000   \n",
       "18        0.000000    0.000000   0.307692        0.000000          0.000000   \n",
       "19        0.000000    0.000000   0.000000        0.000000          0.000000   \n",
       "20        0.000000    0.000000   0.000000        0.000000          0.000000   \n",
       "21        0.000000    0.000000   0.000000        0.000000          0.000000   \n",
       "22        0.000000    0.000000   0.000000        0.000000          0.083333   \n",
       "23        0.000000    0.000000   0.038462        0.000000          0.000000   \n",
       "\n",
       "      School  Student Center  Swim School  Trade School  University  Zoo  \n",
       "0   0.000000        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "1   0.400000        0.000000     0.000000      0.000000    0.050000  0.0  \n",
       "2   0.200000        0.040000     0.040000      0.040000    0.000000  0.0  \n",
       "3   0.352941        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "4   0.000000        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "5   0.500000        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "6   0.333333        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "7   0.270270        0.027027     0.027027      0.027027    0.000000  0.0  \n",
       "8   0.416667        0.000000     0.000000      0.000000    0.041667  0.0  \n",
       "9   0.333333        0.000000     0.000000      0.111111    0.000000  0.0  \n",
       "10  0.000000        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "11  0.333333        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "12  0.300000        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "13  0.230769        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "14  0.321429        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "15  0.476190        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "16  0.352941        0.000000     0.000000      0.000000    0.058824  0.0  \n",
       "17  0.421053        0.000000     0.000000      0.000000    0.052632  0.0  \n",
       "18  0.307692        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "19  0.500000        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "20  0.000000        0.000000     0.000000      0.000000    0.000000  1.0  \n",
       "21  0.000000        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "22  0.333333        0.000000     0.000000      0.000000    0.000000  0.0  \n",
       "23  0.461538        0.000000     0.000000      0.000000    0.000000  0.0  "
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "miami_grouped = miami_onehot.groupby('Neighborhood').mean().reset_index()\n",
    "miami_grouped"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Let's confirm the new size\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(24, 29)"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "miami_grouped.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Let's print each neighborhood along with the top 5 most common venues\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "----Allapattah----\n",
      "                       venue  freq\n",
      "0          Elementary School  0.57\n",
      "1              Middle School  0.14\n",
      "2  College Academic Building  0.14\n",
      "3                High School  0.14\n",
      "4               Music School  0.00\n",
      "\n",
      "\n",
      "----Arts & Entertainment District----\n",
      "                    venue  freq\n",
      "0                  School  0.40\n",
      "1       Elementary School  0.20\n",
      "2             High School  0.10\n",
      "3         Language School  0.10\n",
      "4  Adult Education Center  0.05\n",
      "\n",
      "\n",
      "----Brickell----\n",
      "                    venue  freq\n",
      "0                  School  0.20\n",
      "1               Preschool  0.20\n",
      "2         Language School  0.12\n",
      "3          Private School  0.08\n",
      "4  Adult Education Center  0.04\n",
      "\n",
      "\n",
      "----Buena Vista----\n",
      "                venue  freq\n",
      "0              School  0.35\n",
      "1         High School  0.18\n",
      "2   Elementary School  0.18\n",
      "3  Miscellaneous Shop  0.06\n",
      "4         Art Gallery  0.06\n",
      "\n",
      "\n",
      "----Coconut Grove----\n",
      "                       venue  freq\n",
      "0  College Academic Building   0.4\n",
      "1           Business Service   0.2\n",
      "2                     Church   0.2\n",
      "3          Elementary School   0.2\n",
      "4     Adult Education Center   0.0\n",
      "\n",
      "\n",
      "----Coral Way----\n",
      "                    venue  freq\n",
      "0                  School  0.50\n",
      "1       Elementary School  0.33\n",
      "2          Nursery School  0.17\n",
      "3  Adult Education Center  0.00\n",
      "4      Miscellaneous Shop  0.00\n",
      "\n",
      "\n",
      "----Design District----\n",
      "                venue  freq\n",
      "0              School  0.33\n",
      "1   Elementary School  0.22\n",
      "2         High School  0.17\n",
      "3  Miscellaneous Shop  0.06\n",
      "4         Art Gallery  0.06\n",
      "\n",
      "\n",
      "----Downtown----\n",
      "               venue  freq\n",
      "0             School  0.27\n",
      "1  Elementary School  0.14\n",
      "2    Language School  0.11\n",
      "3          Preschool  0.08\n",
      "4     Private School  0.05\n",
      "\n",
      "\n",
      "----Edgewater----\n",
      "                    venue  freq\n",
      "0                  School  0.42\n",
      "1       Elementary School  0.17\n",
      "2             High School  0.12\n",
      "3         Language School  0.08\n",
      "4  Adult Education Center  0.04\n",
      "\n",
      "\n",
      "----Flagami----\n",
      "           venue  freq\n",
      "0         School  0.33\n",
      "1   Music School  0.22\n",
      "2  Middle School  0.11\n",
      "3   Trade School  0.11\n",
      "4        Daycare  0.11\n",
      "\n",
      "\n",
      "----Grapeland Heights----\n",
      "                    venue  freq\n",
      "0          Driving School   0.5\n",
      "1             Golf Course   0.5\n",
      "2  Adult Education Center   0.0\n",
      "3      Miscellaneous Shop   0.0\n",
      "4              University   0.0\n",
      "\n",
      "\n",
      "----Liberty City----\n",
      "                    venue  freq\n",
      "0       Elementary School  0.50\n",
      "1                  School  0.33\n",
      "2             High School  0.17\n",
      "3  Adult Education Center  0.00\n",
      "4      Miscellaneous Shop  0.00\n",
      "\n",
      "\n",
      "----Little Haiti----\n",
      "                   venue  freq\n",
      "0                 School   0.3\n",
      "1      Elementary School   0.2\n",
      "2            High School   0.2\n",
      "3          Middle School   0.1\n",
      "4  College Arts Building   0.1\n",
      "\n",
      "\n",
      "----Little Havana----\n",
      "               venue  freq\n",
      "0  Elementary School  0.38\n",
      "1             School  0.23\n",
      "2      Middle School  0.08\n",
      "3       Music School  0.08\n",
      "4     Private School  0.08\n",
      "\n",
      "\n",
      "----Lummus Park----\n",
      "                          venue  freq\n",
      "0                        School  0.32\n",
      "1             Elementary School  0.18\n",
      "2                   High School  0.11\n",
      "3               Language School  0.07\n",
      "4  General College & University  0.07\n",
      "\n",
      "\n",
      "----Midtown----\n",
      "                    venue  freq\n",
      "0                  School  0.48\n",
      "1       Elementary School  0.14\n",
      "2             High School  0.10\n",
      "3  Adult Education Center  0.05\n",
      "4      Miscellaneous Shop  0.05\n",
      "\n",
      "\n",
      "----Overtown----\n",
      "               venue  freq\n",
      "0             School  0.35\n",
      "1  Elementary School  0.18\n",
      "2        High School  0.18\n",
      "3       Music School  0.06\n",
      "4         University  0.06\n",
      "\n",
      "\n",
      "----Park West----\n",
      "               venue  freq\n",
      "0             School  0.42\n",
      "1  Elementary School  0.16\n",
      "2        High School  0.16\n",
      "3    Language School  0.11\n",
      "4         University  0.05\n",
      "\n",
      "\n",
      "----The Roads----\n",
      "                venue  freq\n",
      "0              School  0.31\n",
      "1   Elementary School  0.31\n",
      "2           Preschool  0.31\n",
      "3       Middle School  0.08\n",
      "4  Miscellaneous Shop  0.00\n",
      "\n",
      "\n",
      "----Upper Eastside----\n",
      "                    venue  freq\n",
      "0                  School  0.50\n",
      "1       Elementary School  0.25\n",
      "2             High School  0.25\n",
      "3  Adult Education Center  0.00\n",
      "4      Miscellaneous Shop  0.00\n",
      "\n",
      "\n",
      "----Venetian Islands----\n",
      "          venue  freq\n",
      "0           Zoo   1.0\n",
      "1   Art Gallery   0.0\n",
      "2    University   0.0\n",
      "3  Trade School   0.0\n",
      "4   Swim School   0.0\n",
      "\n",
      "\n",
      "----Virginia Key----\n",
      "                    venue  freq\n",
      "0             College Lab   0.5\n",
      "1             High School   0.5\n",
      "2  Adult Education Center   0.0\n",
      "3      Miscellaneous Shop   0.0\n",
      "4              University   0.0\n",
      "\n",
      "\n",
      "----West Flagler----\n",
      "               venue  freq\n",
      "0             School  0.33\n",
      "1  Elementary School  0.33\n",
      "2        High School  0.17\n",
      "3      Middle School  0.08\n",
      "4   Religious School  0.08\n",
      "\n",
      "\n",
      "----Wynwood----\n",
      "                    venue  freq\n",
      "0                  School  0.46\n",
      "1       Elementary School  0.23\n",
      "2             High School  0.08\n",
      "3  Adult Education Center  0.04\n",
      "4      Miscellaneous Shop  0.04\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "num_top_venues = 5\n",
    "\n",
    "for hood in miami_grouped['Neighborhood']:\n",
    "    print(\"----\"+hood+\"----\")\n",
    "    temp = miami_grouped[miami_grouped['Neighborhood'] == hood].T.reset_index()\n",
    "    temp.columns = ['venue','freq']\n",
    "    temp = temp.iloc[1:]\n",
    "    temp['freq'] = temp['freq'].astype(float)\n",
    "    temp = temp.round({'freq': 2})\n",
    "    print(temp.sort_values('freq', ascending=False).reset_index(drop=True).head(num_top_venues))\n",
    "    print('\\n')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Let's put that into a _pandas_ dataframe\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "First, let's write a function to sort the venues in descending order.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [],
   "source": [
    "def return_most_common_venues(row, num_top_venues):\n",
    "    row_categories = row.iloc[1:]\n",
    "    row_categories_sorted = row_categories.sort_values(ascending=False)\n",
    "    \n",
    "    return row_categories_sorted.index.values[0:num_top_venues]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now let's create the new dataframe and display the top 10 venues for each neighborhood.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [],
   "source": [
    "num_top_venues = 10\n",
    "\n",
    "indicators = ['st', 'nd', 'rd']\n",
    "\n",
    "# create columns according to number of top venues\n",
    "columns = ['Neighborhood']\n",
    "for ind in np.arange(num_top_venues):\n",
    "    try:\n",
    "        columns.append('{}{} Most Common Venue'.format(ind+1, indicators[ind]))\n",
    "    except:\n",
    "        columns.append('{}th Most Common Venue'.format(ind+1))\n",
    "\n",
    "# create a new dataframe\n",
    "neighborhoods_venues_sorted = pd.DataFrame(columns=columns)\n",
    "neighborhoods_venues_sorted['Neighborhood'] = miami_grouped['Neighborhood']\n",
    "\n",
    "for ind in np.arange(miami_grouped.shape[0]):\n",
    "    neighborhoods_venues_sorted.iloc[ind, 1:] = return_most_common_venues(miami_grouped.iloc[ind, :], num_top_venues)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Neighborhood</th>\n",
       "      <th>1st Most Common Venue</th>\n",
       "      <th>2nd Most Common Venue</th>\n",
       "      <th>3rd Most Common Venue</th>\n",
       "      <th>4th Most Common Venue</th>\n",
       "      <th>5th Most Common Venue</th>\n",
       "      <th>6th Most Common Venue</th>\n",
       "      <th>7th Most Common Venue</th>\n",
       "      <th>8th Most Common Venue</th>\n",
       "      <th>9th Most Common Venue</th>\n",
       "      <th>10th Most Common Venue</th>\n",
       "      <th>NumberOfInstitutes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Downtown</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Music School</td>\n",
       "      <td>General College &amp; University</td>\n",
       "      <td>Private School</td>\n",
       "      <td>Church</td>\n",
       "      <td>Daycare</td>\n",
       "      <td>High School</td>\n",
       "      <td>37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Lummus Park</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Music School</td>\n",
       "      <td>General College &amp; University</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Private School</td>\n",
       "      <td>Church</td>\n",
       "      <td>Daycare</td>\n",
       "      <td>Middle School</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Wynwood</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Adult Education Center</td>\n",
       "      <td>Playground</td>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Brickell</td>\n",
       "      <td>School</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Private School</td>\n",
       "      <td>Nursery School</td>\n",
       "      <td>Church</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>General College &amp; University</td>\n",
       "      <td>Middle School</td>\n",
       "      <td>Music School</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Edgewater</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>University</td>\n",
       "      <td>Adult Education Center</td>\n",
       "      <td>Playground</td>\n",
       "      <td>24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Midtown</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Adult Education Center</td>\n",
       "      <td>Playground</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arts &amp; Entertainment District</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>University</td>\n",
       "      <td>Adult Education Center</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Playground</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Park West</td>\n",
       "      <td>School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Daycare</td>\n",
       "      <td>General College &amp; University</td>\n",
       "      <td>University</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Design District</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Buena Vista</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Overtown</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>General College &amp; University</td>\n",
       "      <td>Playground</td>\n",
       "      <td>Music School</td>\n",
       "      <td>University</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>The Roads</td>\n",
       "      <td>School</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>Middle School</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>College Academic Building</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Little Havana</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Private School</td>\n",
       "      <td>Music School</td>\n",
       "      <td>Middle School</td>\n",
       "      <td>High School</td>\n",
       "      <td>General College &amp; University</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>West Flagler</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Religious School</td>\n",
       "      <td>Middle School</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Little Haiti</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Middle School</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Flagami</td>\n",
       "      <td>School</td>\n",
       "      <td>Music School</td>\n",
       "      <td>Trade School</td>\n",
       "      <td>Daycare</td>\n",
       "      <td>Middle School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>College Academic Building</td>\n",
       "      <td>Middle School</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>College Lab</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Liberty City</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>College Academic Building</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>College Lab</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Coral Way</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>Nursery School</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>High School</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>College Academic Building</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Coconut Grove</td>\n",
       "      <td>College Academic Building</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>University</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>College Lab</td>\n",
       "      <td>Daycare</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Upper Eastside</td>\n",
       "      <td>School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>College Academic Building</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>College Lab</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Grapeland Heights</td>\n",
       "      <td>Driving School</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>University</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>College Academic Building</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>College Lab</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Virginia Key</td>\n",
       "      <td>College Lab</td>\n",
       "      <td>High School</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>University</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>College Academic Building</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>Daycare</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Venetian Islands</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>University</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>College Academic Building</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>College Lab</td>\n",
       "      <td>Daycare</td>\n",
       "      <td>Driving School</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Neighborhood      1st Most Common Venue  \\\n",
       "7                        Downtown                     School   \n",
       "14                    Lummus Park                     School   \n",
       "23                        Wynwood                     School   \n",
       "2                        Brickell                     School   \n",
       "8                       Edgewater                     School   \n",
       "15                        Midtown                     School   \n",
       "1   Arts & Entertainment District                     School   \n",
       "17                      Park West                     School   \n",
       "6                 Design District                     School   \n",
       "3                     Buena Vista                     School   \n",
       "16                       Overtown                     School   \n",
       "18                      The Roads                     School   \n",
       "13                  Little Havana          Elementary School   \n",
       "22                   West Flagler                     School   \n",
       "12                   Little Haiti                     School   \n",
       "9                         Flagami                     School   \n",
       "0                      Allapattah          Elementary School   \n",
       "11                   Liberty City          Elementary School   \n",
       "5                       Coral Way                     School   \n",
       "4                   Coconut Grove  College Academic Building   \n",
       "19                 Upper Eastside                     School   \n",
       "10              Grapeland Heights             Driving School   \n",
       "21                   Virginia Key                College Lab   \n",
       "20               Venetian Islands                        Zoo   \n",
       "\n",
       "   2nd Most Common Venue      3rd Most Common Venue  4th Most Common Venue  \\\n",
       "7      Elementary School            Language School              Preschool   \n",
       "14     Elementary School                High School           Music School   \n",
       "23     Elementary School                High School        Language School   \n",
       "2              Preschool            Language School         Private School   \n",
       "8      Elementary School                High School        Language School   \n",
       "15     Elementary School                High School        Language School   \n",
       "1      Elementary School            Language School            High School   \n",
       "17           High School          Elementary School        Language School   \n",
       "6      Elementary School                High School        Language School   \n",
       "3      Elementary School                High School        Language School   \n",
       "16     Elementary School                High School        Language School   \n",
       "18             Preschool          Elementary School          Middle School   \n",
       "13                School            Language School         Private School   \n",
       "22     Elementary School                High School       Religious School   \n",
       "12     Elementary School                High School  College Arts Building   \n",
       "9           Music School               Trade School                Daycare   \n",
       "0            High School  College Academic Building          Middle School   \n",
       "11                School                High School                    Zoo   \n",
       "5      Elementary School             Nursery School                    Zoo   \n",
       "4       Business Service                     Church      Elementary School   \n",
       "19           High School          Elementary School                    Zoo   \n",
       "10           Golf Course                        Zoo             University   \n",
       "21           High School                        Zoo             University   \n",
       "20            University                Art Gallery       Business Service   \n",
       "\n",
       "           5th Most Common Venue         6th Most Common Venue  \\\n",
       "7                   Music School  General College & University   \n",
       "14  General College & University               Language School   \n",
       "23                     Preschool                   Art Gallery   \n",
       "2                 Nursery School                        Church   \n",
       "8             Miscellaneous Shop                   Art Gallery   \n",
       "15                     Preschool                   Art Gallery   \n",
       "1             Miscellaneous Shop                   Art Gallery   \n",
       "17                       Daycare  General College & University   \n",
       "6                    Art Gallery         College Arts Building   \n",
       "3                    Art Gallery         College Arts Building   \n",
       "16  General College & University                    Playground   \n",
       "18                           Zoo                   Golf Course   \n",
       "13                  Music School                 Middle School   \n",
       "22                 Middle School                           Zoo   \n",
       "12                     Preschool                 Middle School   \n",
       "9                  Middle School             Elementary School   \n",
       "0                            Zoo                   Art Gallery   \n",
       "11                   Art Gallery              Business Service   \n",
       "5                    High School                   Art Gallery   \n",
       "4                            Zoo                    University   \n",
       "19                   Art Gallery              Business Service   \n",
       "10                   Art Gallery              Business Service   \n",
       "21                   Art Gallery              Business Service   \n",
       "20                        Church     College Academic Building   \n",
       "\n",
       "    7th Most Common Venue         8th Most Common Venue  \\\n",
       "7          Private School                        Church   \n",
       "14         Private School                        Church   \n",
       "23  College Arts Building            Miscellaneous Shop   \n",
       "2       Elementary School  General College & University   \n",
       "8   College Arts Building                    University   \n",
       "15  College Arts Building            Miscellaneous Shop   \n",
       "1              University        Adult Education Center   \n",
       "17             University                   Art Gallery   \n",
       "6               Preschool            Miscellaneous Shop   \n",
       "3               Preschool            Miscellaneous Shop   \n",
       "16           Music School                    University   \n",
       "18            Art Gallery              Business Service   \n",
       "13            High School  General College & University   \n",
       "22            Golf Course                   Art Gallery   \n",
       "12                    Zoo                   Golf Course   \n",
       "9                     Zoo                   Golf Course   \n",
       "0        Business Service                        Church   \n",
       "11                 Church     College Academic Building   \n",
       "5        Business Service                        Church   \n",
       "4             Art Gallery         College Arts Building   \n",
       "19                 Church     College Academic Building   \n",
       "10                 Church     College Academic Building   \n",
       "21                 Church     College Academic Building   \n",
       "20  College Arts Building                   College Lab   \n",
       "\n",
       "        9th Most Common Venue     10th Most Common Venue  NumberOfInstitutes  \n",
       "7                     Daycare                High School                  37  \n",
       "14                    Daycare              Middle School                  28  \n",
       "23     Adult Education Center                 Playground                  26  \n",
       "2               Middle School               Music School                  25  \n",
       "8      Adult Education Center                 Playground                  24  \n",
       "15     Adult Education Center                 Playground                  21  \n",
       "1                   Preschool                 Playground                  20  \n",
       "17           Business Service                     Church                  19  \n",
       "6                 Golf Course           Business Service                  18  \n",
       "3                 Golf Course           Business Service                  17  \n",
       "16                Art Gallery           Business Service                  17  \n",
       "18                     Church  College Academic Building                  13  \n",
       "13                Art Gallery           Business Service                  13  \n",
       "22           Business Service                     Church                  12  \n",
       "12                Art Gallery           Business Service                  10  \n",
       "9                 Art Gallery           Business Service                   9  \n",
       "0       College Arts Building                College Lab                   7  \n",
       "11      College Arts Building                College Lab                   6  \n",
       "5   College Academic Building      College Arts Building                   6  \n",
       "4                 College Lab                    Daycare                   5  \n",
       "19      College Arts Building                College Lab                   4  \n",
       "10      College Arts Building                College Lab                   2  \n",
       "21      College Arts Building                    Daycare                   2  \n",
       "20                    Daycare             Driving School                   1  "
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfGroup.reset_index()\n",
    "neighborhoods_venues_sorted = neighborhoods_venues_sorted.join(dfGroup, on='Neighborhood')\n",
    "neighborhoods_venues_sorted.sort_values(['NumberOfInstitutes'], ascending=[False], inplace=True)\n",
    "neighborhoods_venues_sorted.head(28)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [],
   "source": [
    "neighborhoods_venues_sorted.sort_values(['NumberOfInstitutes'], ascending=[False], inplace=True)\n",
    "neighborhoods_venues_sorted.reset_index(inplace=True)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Top 10 Neighborhood based on Educational Density"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Neighborhood</th>\n",
       "      <th>1st Most Common Venue</th>\n",
       "      <th>2nd Most Common Venue</th>\n",
       "      <th>3rd Most Common Venue</th>\n",
       "      <th>4th Most Common Venue</th>\n",
       "      <th>5th Most Common Venue</th>\n",
       "      <th>6th Most Common Venue</th>\n",
       "      <th>7th Most Common Venue</th>\n",
       "      <th>8th Most Common Venue</th>\n",
       "      <th>9th Most Common Venue</th>\n",
       "      <th>10th Most Common Venue</th>\n",
       "      <th>NumberOfInstitutes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Downtown</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Music School</td>\n",
       "      <td>General College &amp; University</td>\n",
       "      <td>Private School</td>\n",
       "      <td>Church</td>\n",
       "      <td>Daycare</td>\n",
       "      <td>High School</td>\n",
       "      <td>37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Lummus Park</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Music School</td>\n",
       "      <td>General College &amp; University</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Private School</td>\n",
       "      <td>Church</td>\n",
       "      <td>Daycare</td>\n",
       "      <td>Middle School</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Wynwood</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Adult Education Center</td>\n",
       "      <td>Playground</td>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Brickell</td>\n",
       "      <td>School</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Private School</td>\n",
       "      <td>Nursery School</td>\n",
       "      <td>Church</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>General College &amp; University</td>\n",
       "      <td>Middle School</td>\n",
       "      <td>Music School</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Edgewater</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>University</td>\n",
       "      <td>Adult Education Center</td>\n",
       "      <td>Playground</td>\n",
       "      <td>24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Midtown</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Adult Education Center</td>\n",
       "      <td>Playground</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Arts &amp; Entertainment District</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>University</td>\n",
       "      <td>Adult Education Center</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Playground</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Park West</td>\n",
       "      <td>School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Daycare</td>\n",
       "      <td>General College &amp; University</td>\n",
       "      <td>University</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>Church</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Design District</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Buena Vista</td>\n",
       "      <td>School</td>\n",
       "      <td>Elementary School</td>\n",
       "      <td>High School</td>\n",
       "      <td>Language School</td>\n",
       "      <td>Art Gallery</td>\n",
       "      <td>College Arts Building</td>\n",
       "      <td>Preschool</td>\n",
       "      <td>Miscellaneous Shop</td>\n",
       "      <td>Golf Course</td>\n",
       "      <td>Business Service</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    Neighborhood 1st Most Common Venue 2nd Most Common Venue  \\\n",
       "0                       Downtown                School     Elementary School   \n",
       "1                    Lummus Park                School     Elementary School   \n",
       "2                        Wynwood                School     Elementary School   \n",
       "3                       Brickell                School             Preschool   \n",
       "4                      Edgewater                School     Elementary School   \n",
       "5                        Midtown                School     Elementary School   \n",
       "6  Arts & Entertainment District                School     Elementary School   \n",
       "7                      Park West                School           High School   \n",
       "8                Design District                School     Elementary School   \n",
       "9                    Buena Vista                School     Elementary School   \n",
       "\n",
       "  3rd Most Common Venue 4th Most Common Venue         5th Most Common Venue  \\\n",
       "0       Language School             Preschool                  Music School   \n",
       "1           High School          Music School  General College & University   \n",
       "2           High School       Language School                     Preschool   \n",
       "3       Language School        Private School                Nursery School   \n",
       "4           High School       Language School            Miscellaneous Shop   \n",
       "5           High School       Language School                     Preschool   \n",
       "6       Language School           High School            Miscellaneous Shop   \n",
       "7     Elementary School       Language School                       Daycare   \n",
       "8           High School       Language School                   Art Gallery   \n",
       "9           High School       Language School                   Art Gallery   \n",
       "\n",
       "          6th Most Common Venue  7th Most Common Venue  \\\n",
       "0  General College & University         Private School   \n",
       "1               Language School         Private School   \n",
       "2                   Art Gallery  College Arts Building   \n",
       "3                        Church      Elementary School   \n",
       "4                   Art Gallery  College Arts Building   \n",
       "5                   Art Gallery  College Arts Building   \n",
       "6                   Art Gallery             University   \n",
       "7  General College & University             University   \n",
       "8         College Arts Building              Preschool   \n",
       "9         College Arts Building              Preschool   \n",
       "\n",
       "          8th Most Common Venue   9th Most Common Venue  \\\n",
       "0                        Church                 Daycare   \n",
       "1                        Church                 Daycare   \n",
       "2            Miscellaneous Shop  Adult Education Center   \n",
       "3  General College & University           Middle School   \n",
       "4                    University  Adult Education Center   \n",
       "5            Miscellaneous Shop  Adult Education Center   \n",
       "6        Adult Education Center               Preschool   \n",
       "7                   Art Gallery        Business Service   \n",
       "8            Miscellaneous Shop             Golf Course   \n",
       "9            Miscellaneous Shop             Golf Course   \n",
       "\n",
       "  10th Most Common Venue  NumberOfInstitutes  \n",
       "0            High School                  37  \n",
       "1          Middle School                  28  \n",
       "2             Playground                  26  \n",
       "3           Music School                  25  \n",
       "4             Playground                  24  \n",
       "5             Playground                  21  \n",
       "6             Playground                  20  \n",
       "7                 Church                  19  \n",
       "8       Business Service                  18  \n",
       "9       Business Service                  17  "
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "neighborhoods_venues_sorted.drop([\"index\"], axis = 1, inplace=True) \n",
    "neighborhoods_venues_sorted.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Neighborhood</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "      <th>NumberOfInstitutes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Allapattah</td>\n",
       "      <td>25.815</td>\n",
       "      <td>-80.224</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arts &amp; Entertainment District</td>\n",
       "      <td>25.799</td>\n",
       "      <td>-80.190</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Brickell</td>\n",
       "      <td>25.758</td>\n",
       "      <td>-80.193</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Buena Vista</td>\n",
       "      <td>25.813</td>\n",
       "      <td>-80.192</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Coconut Grove</td>\n",
       "      <td>25.712</td>\n",
       "      <td>-80.257</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Coral Way</td>\n",
       "      <td>25.750</td>\n",
       "      <td>-80.283</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Design District</td>\n",
       "      <td>25.813</td>\n",
       "      <td>-80.193</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Downtown</td>\n",
       "      <td>25.774</td>\n",
       "      <td>-80.193</td>\n",
       "      <td>37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Edgewater</td>\n",
       "      <td>25.802</td>\n",
       "      <td>-80.190</td>\n",
       "      <td>24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Flagami</td>\n",
       "      <td>25.762</td>\n",
       "      <td>-80.316</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Grapeland Heights</td>\n",
       "      <td>25.792</td>\n",
       "      <td>-80.258</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Liberty City</td>\n",
       "      <td>25.832</td>\n",
       "      <td>-80.225</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Little Haiti</td>\n",
       "      <td>25.824</td>\n",
       "      <td>-80.191</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Little Havana</td>\n",
       "      <td>25.773</td>\n",
       "      <td>-80.215</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Lummus Park</td>\n",
       "      <td>25.777</td>\n",
       "      <td>-80.201</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Midtown</td>\n",
       "      <td>25.807</td>\n",
       "      <td>-80.193</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Overtown</td>\n",
       "      <td>25.787</td>\n",
       "      <td>-80.201</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Park West</td>\n",
       "      <td>25.785</td>\n",
       "      <td>-80.193</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>The Roads</td>\n",
       "      <td>25.756</td>\n",
       "      <td>-80.207</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Upper Eastside</td>\n",
       "      <td>25.830</td>\n",
       "      <td>-80.183</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Venetian Islands</td>\n",
       "      <td>25.791</td>\n",
       "      <td>-80.161</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Virginia Key</td>\n",
       "      <td>25.736</td>\n",
       "      <td>-80.155</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>West Flagler</td>\n",
       "      <td>25.775</td>\n",
       "      <td>-80.243</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Wynwood</td>\n",
       "      <td>25.804</td>\n",
       "      <td>-80.199</td>\n",
       "      <td>26</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     Neighborhood  Latitude  Longitude  NumberOfInstitutes\n",
       "0                      Allapattah    25.815    -80.224                   7\n",
       "1   Arts & Entertainment District    25.799    -80.190                  20\n",
       "2                        Brickell    25.758    -80.193                  25\n",
       "3                     Buena Vista    25.813    -80.192                  17\n",
       "4                   Coconut Grove    25.712    -80.257                   5\n",
       "5                       Coral Way    25.750    -80.283                   6\n",
       "6                 Design District    25.813    -80.193                  18\n",
       "7                        Downtown    25.774    -80.193                  37\n",
       "8                       Edgewater    25.802    -80.190                  24\n",
       "9                         Flagami    25.762    -80.316                   9\n",
       "10              Grapeland Heights    25.792    -80.258                   2\n",
       "12                   Liberty City    25.832    -80.225                   6\n",
       "13                   Little Haiti    25.824    -80.191                  10\n",
       "14                  Little Havana    25.773    -80.215                  13\n",
       "15                    Lummus Park    25.777    -80.201                  28\n",
       "16                        Midtown    25.807    -80.193                  21\n",
       "17                       Overtown    25.787    -80.201                  17\n",
       "18                      Park West    25.785    -80.193                  19\n",
       "19                      The Roads    25.756    -80.207                  13\n",
       "20                 Upper Eastside    25.830    -80.183                   4\n",
       "21               Venetian Islands    25.791    -80.161                   1\n",
       "22                   Virginia Key    25.736    -80.155                   2\n",
       "23                   West Flagler    25.775    -80.243                  12\n",
       "24                        Wynwood    25.804    -80.199                  26"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "miami_merged = neighborhoods\n",
    "\n",
    "# merge miami_merged with neighborhoods to add latitude/longitude for each neighborhood\n",
    "miami_merged = miami_merged.join(dfGroup, on='Neighborhood')\n",
    "\n",
    "\n",
    "miami_merged"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, let's visualize the resulting clusters\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe src=\"about:blank\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" data-html=PCFET0NUWVBFIGh0bWw+CjxoZWFkPiAgICAKICAgIDxtZXRhIGh0dHAtZXF1aXY9ImNvbnRlbnQtdHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PVVURi04IiAvPgogICAgPHNjcmlwdD5MX1BSRUZFUl9DQU5WQVMgPSBmYWxzZTsgTF9OT19UT1VDSCA9IGZhbHNlOyBMX0RJU0FCTEVfM0QgPSBmYWxzZTs8L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL2pxdWVyeS8xLjExLjEvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvanMvYm9vdHN0cmFwLm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuanMiPjwvc2NyaXB0PgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLm1pbi5jc3MiLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC10aGVtZS5taW4uY3NzIi8+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuNi4zL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9MZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy8yLjAuMi9sZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy5jc3MiLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9yYXdnaXQuY29tL3B5dGhvbi12aXN1YWxpemF0aW9uL2ZvbGl1bS9tYXN0ZXIvZm9saXVtL3RlbXBsYXRlcy9sZWFmbGV0LmF3ZXNvbWUucm90YXRlLmNzcyIvPgogICAgPHN0eWxlPmh0bWwsIGJvZHkge3dpZHRoOiAxMDAlO2hlaWdodDogMTAwJTttYXJnaW46IDA7cGFkZGluZzogMDt9PC9zdHlsZT4KICAgIDxzdHlsZT4jbWFwIHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3R0b206MDtyaWdodDowO2xlZnQ6MDt9PC9zdHlsZT4KICAgIAogICAgICAgICAgICA8c3R5bGU+ICNtYXBfYWIzM2IxNDdkNzk2NDBkYjk2YTJjNGI5MzRhOTI3NjAgewogICAgICAgICAgICAgICAgcG9zaXRpb24gOiByZWxhdGl2ZTsKICAgICAgICAgICAgICAgIHdpZHRoIDogMTAwLjAlOwogICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAuMCU7CiAgICAgICAgICAgICAgICBsZWZ0OiAwLjAlOwogICAgICAgICAgICAgICAgdG9wOiAwLjAlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICA8L3N0eWxlPgogICAgICAgIAo8L2hlYWQ+Cjxib2R5PiAgICAKICAgIAogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb2xpdW0tbWFwIiBpZD0ibWFwX2FiMzNiMTQ3ZDc5NjQwZGI5NmEyYzRiOTM0YTkyNzYwIiA+PC9kaXY+CiAgICAgICAgCjwvYm9keT4KPHNjcmlwdD4gICAgCiAgICAKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGJvdW5kcyA9IG51bGw7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCA9IEwubWFwKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2VudGVyOiBbMjUuNzc0MjY1OCwtODAuMTkzNjU4OV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6b29tOiAxMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heEJvdW5kczogYm91bmRzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXJzOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmxkQ29weUp1bXA6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JzOiBMLkNSUy5FUFNHMzg1NwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHRpbGVfbGF5ZXJfZjZmZTcxMzkwYTA5NDk5ZmEzNGE2NzY2YTU5Y2U3MDkgPSBMLnRpbGVMYXllcigKICAgICAgICAgICAgICAgICdodHRwczovL3tzfS50aWxlLm9wZW5zdHJlZXRtYXAub3JnL3t6fS97eH0ve3l9LnBuZycsCiAgICAgICAgICAgICAgICB7CiAgImF0dHJpYnV0aW9uIjogbnVsbCwKICAiZGV0ZWN0UmV0aW5hIjogZmFsc2UsCiAgIm1heFpvb20iOiAxOCwKICAibWluWm9vbSI6IDEsCiAgIm5vV3JhcCI6IGZhbHNlLAogICJzdWJkb21haW5zIjogImFiYyIKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYWIzM2IxNDdkNzk2NDBkYjk2YTJjNGI5MzRhOTI3NjApOwogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzAwMWVlNTVjYzQ4ODQ2NmI5MDJkYzZkOTZhNDc4MWJkID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuODE1LC04MC4yMjM5OTk5OTk5OTk5OV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJ5ZWxsb3ciLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAzLjUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYWIzM2IxNDdkNzk2NDBkYjk2YTJjNGI5MzRhOTI3NjApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfODAyY2ZiYzgxMDRlNDM5MjgwNjdiNDgxMmYyMGY3ZTEgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfYTcxOGM1OTBhZWJhNDY4ZTg5Mjk5MDI4YjhlODE1ZTEgPSAkKCc8ZGl2IGlkPSJodG1sX2E3MThjNTkwYWViYTQ2OGU4OTI5OTAyOGI4ZTgxNWUxIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5BbGxhcGF0dGFoPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF84MDJjZmJjODEwNGU0MzkyODA2N2I0ODEyZjIwZjdlMS5zZXRDb250ZW50KGh0bWxfYTcxOGM1OTBhZWJhNDY4ZTg5Mjk5MDI4YjhlODE1ZTEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfMDAxZWU1NWNjNDg4NDY2YjkwMmRjNmQ5NmE0NzgxYmQuYmluZFBvcHVwKHBvcHVwXzgwMmNmYmM4MTA0ZTQzOTI4MDY3YjQ4MTJmMjBmN2UxKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2JlMjA4ZGViODhmNTQ1OTZhNjYzNzA3Mzg0MTk0YmI4ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuNzk5LC04MC4xOV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJ5ZWxsb3ciLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAxMC4wLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2FiMzNiMTQ3ZDc5NjQwZGI5NmEyYzRiOTM0YTkyNzYwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2Q0NjkxOTI5ODI4MzRkNzI4ODFkZGM5ODEwOWViMThmID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2EwNjM4Zjc1NmFhZjQ4YTFiOWFlZGMzYmUzNGZjNGRiID0gJCgnPGRpdiBpZD0iaHRtbF9hMDYzOGY3NTZhYWY0OGExYjlhZWRjM2JlMzRmYzRkYiIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QXJ0cyAmIEVudGVydGFpbm1lbnQgRGlzdHJpY3Q8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2Q0NjkxOTI5ODI4MzRkNzI4ODFkZGM5ODEwOWViMThmLnNldENvbnRlbnQoaHRtbF9hMDYzOGY3NTZhYWY0OGExYjlhZWRjM2JlMzRmYzRkYik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9iZTIwOGRlYjg4ZjU0NTk2YTY2MzcwNzM4NDE5NGJiOC5iaW5kUG9wdXAocG9wdXBfZDQ2OTE5Mjk4MjgzNGQ3Mjg4MWRkYzk4MTA5ZWIxOGYpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfMzI3ZmMyYzU1NTk0NDE1N2E1NDhmMWJjNDczZTMyZmMgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS43NTgwMDAwMDAwMDAwMDMsLTgwLjE5M10sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJ5ZWxsb3ciLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAxMi41LAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2FiMzNiMTQ3ZDc5NjQwZGI5NmEyYzRiOTM0YTkyNzYwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzVhMTJhMTM5NGY2NjQ4MzI4N2RkYWJiZGQ5YzY3MzNlID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzE1ZDkwM2ZiODU2YjRkN2VhZjhlNDEzMzIyYTE4ZTQxID0gJCgnPGRpdiBpZD0iaHRtbF8xNWQ5MDNmYjg1NmI0ZDdlYWY4ZTQxMzMyMmExOGU0MSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+QnJpY2tlbGw8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzVhMTJhMTM5NGY2NjQ4MzI4N2RkYWJiZGQ5YzY3MzNlLnNldENvbnRlbnQoaHRtbF8xNWQ5MDNmYjg1NmI0ZDdlYWY4ZTQxMzMyMmExOGU0MSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8zMjdmYzJjNTU1OTQ0MTU3YTU0OGYxYmM0NzNlMzJmYy5iaW5kUG9wdXAocG9wdXBfNWExMmExMzk0ZjY2NDgzMjg3ZGRhYmJkZDljNjczM2UpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfODliZGI5MWE3MDhiNGFhNGFhMzIwZDJmYWExY2I0ZmUgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS44MTMwMDAwMDAwMDAwMDIsLTgwLjE5Ml0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJ5ZWxsb3ciLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA4LjUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYWIzM2IxNDdkNzk2NDBkYjk2YTJjNGI5MzRhOTI3NjApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfYmFlODk1ZTJiNDZmNDE5MjlhMjdiNjJhNGVjMGMyMDggPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMzUyMzlkZWY1OGYzNDUxN2JjZWUwZGNjMDA5ZWUxMjQgPSAkKCc8ZGl2IGlkPSJodG1sXzM1MjM5ZGVmNThmMzQ1MTdiY2VlMGRjYzAwOWVlMTI0IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5CdWVuYSBWaXN0YTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfYmFlODk1ZTJiNDZmNDE5MjlhMjdiNjJhNGVjMGMyMDguc2V0Q29udGVudChodG1sXzM1MjM5ZGVmNThmMzQ1MTdiY2VlMGRjYzAwOWVlMTI0KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzg5YmRiOTFhNzA4YjRhYTRhYTMyMGQyZmFhMWNiNGZlLmJpbmRQb3B1cChwb3B1cF9iYWU4OTVlMmI0NmY0MTkyOWEyN2I2MmE0ZWMwYzIwOCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8yZWI1YmJmNjdjZjc0NGYyYTRkMGEwMTZkZDlkYjY2NiA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1LjcxMiwtODAuMjU3XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDIuNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF85NTdkZGRkMmZmN2E0MjAyODNkNjExZmI4MzYyYzFiMSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF83MDIxYzBhMzIyZmI0YWM4YmEzMTM2YzdhZDFjYjhjNiA9ICQoJzxkaXYgaWQ9Imh0bWxfNzAyMWMwYTMyMmZiNGFjOGJhMzEzNmM3YWQxY2I4YzYiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkNvY29udXQgR3JvdmU8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzk1N2RkZGQyZmY3YTQyMDI4M2Q2MTFmYjgzNjJjMWIxLnNldENvbnRlbnQoaHRtbF83MDIxYzBhMzIyZmI0YWM4YmEzMTM2YzdhZDFjYjhjNik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8yZWI1YmJmNjdjZjc0NGYyYTRkMGEwMTZkZDlkYjY2Ni5iaW5kUG9wdXAocG9wdXBfOTU3ZGRkZDJmZjdhNDIwMjgzZDYxMWZiODM2MmMxYjEpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfZjE2MWUyMGUxMTQ1NDMwZTk3N2M4OTQzODAxMjE3MDAgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS43NSwtODAuMjgzXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDMuMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9mMWJlMjUzY2NjODA0ODI2ODYzYzNmZWE0MzcyYjI4NyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF85Yjg4ZWRjNmJlOWM0YmQ1YjAxZDQ3NWU5NTA4ZTI2MCA9ICQoJzxkaXYgaWQ9Imh0bWxfOWI4OGVkYzZiZTljNGJkNWIwMWQ0NzVlOTUwOGUyNjAiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkNvcmFsIFdheTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZjFiZTI1M2NjYzgwNDgyNjg2M2MzZmVhNDM3MmIyODcuc2V0Q29udGVudChodG1sXzliODhlZGM2YmU5YzRiZDViMDFkNDc1ZTk1MDhlMjYwKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyX2YxNjFlMjBlMTE0NTQzMGU5NzdjODk0MzgwMTIxNzAwLmJpbmRQb3B1cChwb3B1cF9mMWJlMjUzY2NjODA0ODI2ODYzYzNmZWE0MzcyYjI4Nyk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8yM2QzZTM4MWU5YWQ0M2IzODIxNzY4NmZkNTg0Yjg5NyA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1LjgxMzAwMDAwMDAwMDAwMiwtODAuMTkzXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDkuMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF85N2ViZmNhN2I5Nzk0MzA5ODkyMjE5MmQzMTNjMTA3YiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF82ZTYyZTU2NzJiMTg0NGNkODc1ZjY1NDMxOTMyZmQ3MSA9ICQoJzxkaXYgaWQ9Imh0bWxfNmU2MmU1NjcyYjE4NDRjZDg3NWY2NTQzMTkzMmZkNzEiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkRlc2lnbiBEaXN0cmljdDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfOTdlYmZjYTdiOTc5NDMwOTg5MjIxOTJkMzEzYzEwN2Iuc2V0Q29udGVudChodG1sXzZlNjJlNTY3MmIxODQ0Y2Q4NzVmNjU0MzE5MzJmZDcxKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzIzZDNlMzgxZTlhZDQzYjM4MjE3Njg2ZmQ1ODRiODk3LmJpbmRQb3B1cChwb3B1cF85N2ViZmNhN2I5Nzk0MzA5ODkyMjE5MmQzMTNjMTA3Yik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8zODhlZGNjMjBmNDc0MDlkOTM4NTQ5NzNiNWIzMTg0NCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1Ljc3NCwtODAuMTkzXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDE4LjUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYWIzM2IxNDdkNzk2NDBkYjk2YTJjNGI5MzRhOTI3NjApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZWFjOGFhZjM4NjZjNDVjNThiOGFlMWYzMzQ2ODI1MjQgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNjM2ZDJjNjg0YjdhNDQzMGJkYTM5MWQ3OTlkYWQ1YzUgPSAkKCc8ZGl2IGlkPSJodG1sXzYzNmQyYzY4NGI3YTQ0MzBiZGEzOTFkNzk5ZGFkNWM1IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5Eb3dudG93bjwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZWFjOGFhZjM4NjZjNDVjNThiOGFlMWYzMzQ2ODI1MjQuc2V0Q29udGVudChodG1sXzYzNmQyYzY4NGI3YTQ0MzBiZGEzOTFkNzk5ZGFkNWM1KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzM4OGVkY2MyMGY0NzQwOWQ5Mzg1NDk3M2I1YjMxODQ0LmJpbmRQb3B1cChwb3B1cF9lYWM4YWFmMzg2NmM0NWM1OGI4YWUxZjMzNDY4MjUyNCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl84YjhmYjM1NzgwYjE0N2FmOWU2M2QwYzBmMGZmMTNhZiA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1LjgwMiwtODAuMTldLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAieWVsbG93IiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTIuMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8zMjRmZDFmZGI4YTA0MzkwOTgxYWUzYmIwMjc0YTgyYiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8xM2RhZDhhZDc3ZTc0YzcxOWExMTIyNTg3ZjMxZmY2YyA9ICQoJzxkaXYgaWQ9Imh0bWxfMTNkYWQ4YWQ3N2U3NGM3MTlhMTEyMjU4N2YzMWZmNmMiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkVkZ2V3YXRlcjwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMzI0ZmQxZmRiOGEwNDM5MDk4MWFlM2JiMDI3NGE4MmIuc2V0Q29udGVudChodG1sXzEzZGFkOGFkNzdlNzRjNzE5YTExMjI1ODdmMzFmZjZjKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzhiOGZiMzU3ODBiMTQ3YWY5ZTYzZDBjMGYwZmYxM2FmLmJpbmRQb3B1cChwb3B1cF8zMjRmZDFmZGI4YTA0MzkwOTgxYWUzYmIwMjc0YTgyYik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl9iYmQxMjI1ZjkyMTY0OWM0YTkyMzVjMjRhZWUzMmMyMCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1Ljc2MTk5OTk5OTk5OTk5NywtODAuMzE2XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDQuNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9kODRiNTBiYzZlYmE0N2U1OTY1ODQ1MjIyNDY1OGEwOCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8xOTQ5MGM2ZDA4YjM0MDY5YjBjNjBmMmEzOGZjOWFmNSA9ICQoJzxkaXYgaWQ9Imh0bWxfMTk0OTBjNmQwOGIzNDA2OWIwYzYwZjJhMzhmYzlhZjUiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkZsYWdhbWk8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2Q4NGI1MGJjNmViYTQ3ZTU5NjU4NDUyMjI0NjU4YTA4LnNldENvbnRlbnQoaHRtbF8xOTQ5MGM2ZDA4YjM0MDY5YjBjNjBmMmEzOGZjOWFmNSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9iYmQxMjI1ZjkyMTY0OWM0YTkyMzVjMjRhZWUzMmMyMC5iaW5kUG9wdXAocG9wdXBfZDg0YjUwYmM2ZWJhNDdlNTk2NTg0NTIyMjQ2NThhMDgpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfYmU5NjFhOWM4NjYxNGRlMThjYzgwOGE0OWNiMjEzY2UgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS43OTE5OTk5OTk5OTk5OTgsLTgwLjI1OF0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJ5ZWxsb3ciLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAxLjAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYWIzM2IxNDdkNzk2NDBkYjk2YTJjNGI5MzRhOTI3NjApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfY2ZmMzEyZTk2Zjg4NGJkNWE3ZmZkZTJlMWIyOGE1OTIgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfZGQ0YjNmYmExMzUzNGYzNzlhY2M1MzQ0OWZjZmZmNTcgPSAkKCc8ZGl2IGlkPSJodG1sX2RkNGIzZmJhMTM1MzRmMzc5YWNjNTM0NDlmY2ZmZjU3IiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5HcmFwZWxhbmQgSGVpZ2h0czwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfY2ZmMzEyZTk2Zjg4NGJkNWE3ZmZkZTJlMWIyOGE1OTIuc2V0Q29udGVudChodG1sX2RkNGIzZmJhMTM1MzRmMzc5YWNjNTM0NDlmY2ZmZjU3KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyX2JlOTYxYTljODY2MTRkZTE4Y2M4MDhhNDljYjIxM2NlLmJpbmRQb3B1cChwb3B1cF9jZmYzMTJlOTZmODg0YmQ1YTdmZmRlMmUxYjI4YTU5Mik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl80NTliMDkyZjY2ZjM0M2M5OTcyZmU4YmVlNzYzNTNiMCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1LjgzMTk5OTk5OTk5OTk5NywtODAuMjI1XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDMuMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9mNzdmMDA1MjNlNzE0NjY5YWIxMGMzYWU3NTU0YTA4ZCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9lOWZiYjM2NjYyMmI0ZTE2ODdiZDQ0ZjFkMWNjNGE0YSA9ICQoJzxkaXYgaWQ9Imh0bWxfZTlmYmIzNjY2MjJiNGUxNjg3YmQ0NGYxZDFjYzRhNGEiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkxpYmVydHkgQ2l0eTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZjc3ZjAwNTIzZTcxNDY2OWFiMTBjM2FlNzU1NGEwOGQuc2V0Q29udGVudChodG1sX2U5ZmJiMzY2NjIyYjRlMTY4N2JkNDRmMWQxY2M0YTRhKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzQ1OWIwOTJmNjZmMzQzYzk5NzJmZThiZWU3NjM1M2IwLmJpbmRQb3B1cChwb3B1cF9mNzdmMDA1MjNlNzE0NjY5YWIxMGMzYWU3NTU0YTA4ZCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8xM2U0YmI1MjM2MWQ0MjQzODUxNjhmYjNlMzgzZDExZSA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1LjgyNCwtODAuMTkxXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDUuMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9jY2E0N2ZmMTM5OWY0Y2M2YWZiNTAyNjNlZTc5Y2NkZiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9iODBkNjY3MjFlOTg0YzRjODg4MDg3YWNkYWQyZTVmOCA9ICQoJzxkaXYgaWQ9Imh0bWxfYjgwZDY2NzIxZTk4NGM0Yzg4ODA4N2FjZGFkMmU1ZjgiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkxpdHRsZSBIYWl0aTwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfY2NhNDdmZjEzOTlmNGNjNmFmYjUwMjYzZWU3OWNjZGYuc2V0Q29udGVudChodG1sX2I4MGQ2NjcyMWU5ODRjNGM4ODgwODdhY2RhZDJlNWY4KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzEzZTRiYjUyMzYxZDQyNDM4NTE2OGZiM2UzODNkMTFlLmJpbmRQb3B1cChwb3B1cF9jY2E0N2ZmMTM5OWY0Y2M2YWZiNTAyNjNlZTc5Y2NkZik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl81MDk2NzE4YmU5ZGE0MGUzYTY0NjhjOTkyMmJiMzU4NCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1Ljc3MzAwMDAwMDAwMDAwMywtODAuMjE1XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDYuNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8yODM3ZGY2ODQ3MDk0OWM2YWY3MTQwMmM3MTlkMjVlNiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8xMjQ1ZjY4YmMxYmE0ZmIyOWZiMjMxYWE4YTE4NTNhNSA9ICQoJzxkaXYgaWQ9Imh0bWxfMTI0NWY2OGJjMWJhNGZiMjlmYjIzMWFhOGExODUzYTUiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPkxpdHRsZSBIYXZhbmE8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzI4MzdkZjY4NDcwOTQ5YzZhZjcxNDAyYzcxOWQyNWU2LnNldENvbnRlbnQoaHRtbF8xMjQ1ZjY4YmMxYmE0ZmIyOWZiMjMxYWE4YTE4NTNhNSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl81MDk2NzE4YmU5ZGE0MGUzYTY0NjhjOTkyMmJiMzU4NC5iaW5kUG9wdXAocG9wdXBfMjgzN2RmNjg0NzA5NDljNmFmNzE0MDJjNzE5ZDI1ZTYpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfNTJhN2U4OGEwZjBkNDM0Mjk5ZDk2NjJiNDE2NGVkNzAgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS43NzY5OTk5OTk5OTk5OTcsLTgwLjIwMTAwMDAwMDAwMDAxXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDE0LjAsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYWIzM2IxNDdkNzk2NDBkYjk2YTJjNGI5MzRhOTI3NjApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZjU5YzEzYjM4NWU2NGUyMjk3OWRjMDE5YmM4MWYwYzEgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNTFkMGFkYzc2MDc3NGZhYmI4Y2M1M2Q3MTcwYTdkM2UgPSAkKCc8ZGl2IGlkPSJodG1sXzUxZDBhZGM3NjA3NzRmYWJiOGNjNTNkNzE3MGE3ZDNlIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5MdW1tdXMgUGFyazwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZjU5YzEzYjM4NWU2NGUyMjk3OWRjMDE5YmM4MWYwYzEuc2V0Q29udGVudChodG1sXzUxZDBhZGM3NjA3NzRmYWJiOGNjNTNkNzE3MGE3ZDNlKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzUyYTdlODhhMGYwZDQzNDI5OWQ5NjYyYjQxNjRlZDcwLmJpbmRQb3B1cChwb3B1cF9mNTljMTNiMzg1ZTY0ZTIyOTc5ZGMwMTliYzgxZjBjMSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl9mOGZiOTk3YzlkN2Q0ZDYxYWE2OWM3OWI5NGMzM2VmYSA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1LjgwNywtODAuMTkzXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDEwLjUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYWIzM2IxNDdkNzk2NDBkYjk2YTJjNGI5MzRhOTI3NjApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZGE4ZWNkMjcwOGNmNGUxMWFmZDA5OWIwNDUxNTQ5YjkgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfZTIyMTk5NWM3NTc5NDU4N2IwMWY3MjYzNjU3ZjA1M2UgPSAkKCc8ZGl2IGlkPSJodG1sX2UyMjE5OTVjNzU3OTQ1ODdiMDFmNzI2MzY1N2YwNTNlIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5NaWR0b3duPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9kYThlY2QyNzA4Y2Y0ZTExYWZkMDk5YjA0NTE1NDliOS5zZXRDb250ZW50KGh0bWxfZTIyMTk5NWM3NTc5NDU4N2IwMWY3MjYzNjU3ZjA1M2UpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfZjhmYjk5N2M5ZDdkNGQ2MWFhNjljNzliOTRjMzNlZmEuYmluZFBvcHVwKHBvcHVwX2RhOGVjZDI3MDhjZjRlMTFhZmQwOTliMDQ1MTU0OWI5KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzM2NGJiYWEwZWNiOTRlOTM4NzIwNzJjMTY4MDVlZjlhID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuNzg3LC04MC4yMDEwMDAwMDAwMDAwMV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJ5ZWxsb3ciLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiA4LjUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYWIzM2IxNDdkNzk2NDBkYjk2YTJjNGI5MzRhOTI3NjApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNzlhYjMzMDhmZDMyNDJmMWJjNmM0MDZkYzBmMDc2YzIgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMDdkMmI2NGNmZWMyNDVjZWJhYzhhZjhlN2QyNjczNDMgPSAkKCc8ZGl2IGlkPSJodG1sXzA3ZDJiNjRjZmVjMjQ1Y2ViYWM4YWY4ZTdkMjY3MzQzIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5PdmVydG93bjwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfNzlhYjMzMDhmZDMyNDJmMWJjNmM0MDZkYzBmMDc2YzIuc2V0Q29udGVudChodG1sXzA3ZDJiNjRjZmVjMjQ1Y2ViYWM4YWY4ZTdkMjY3MzQzKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzM2NGJiYWEwZWNiOTRlOTM4NzIwNzJjMTY4MDVlZjlhLmJpbmRQb3B1cChwb3B1cF83OWFiMzMwOGZkMzI0MmYxYmM2YzQwNmRjMGYwNzZjMik7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl9kMDg0MzljYzUzMTQ0YmQxOTVkNTgyOWI1MDJlMjQ1YiA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1Ljc4NSwtODAuMTkzXSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDkuNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9hMzFhNDFjODQ5Yjc0MjM5YjA5NDcyMmU4MzI1YWUyMSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8xNmZkMTRmOGZiNmE0NDlkOTZjMDhjOTVjOTMwYTEwYiA9ICQoJzxkaXYgaWQ9Imh0bWxfMTZmZDE0ZjhmYjZhNDQ5ZDk2YzA4Yzk1YzkzMGExMGIiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPlBhcmsgV2VzdDwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfYTMxYTQxYzg0OWI3NDIzOWIwOTQ3MjJlODMyNWFlMjEuc2V0Q29udGVudChodG1sXzE2ZmQxNGY4ZmI2YTQ0OWQ5NmMwOGM5NWM5MzBhMTBiKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyX2QwODQzOWNjNTMxNDRiZDE5NWQ1ODI5YjUwMmUyNDViLmJpbmRQb3B1cChwb3B1cF9hMzFhNDFjODQ5Yjc0MjM5YjA5NDcyMmU4MzI1YWUyMSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl83NzhmYTJkMTU0ZWI0MTk4OWUxMWY1NDhkZDQxMDExOCA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1Ljc1NiwtODAuMjA3XSwKICAgICAgICAgICAgICAgIHsKICAiYnViYmxpbmdNb3VzZUV2ZW50cyI6IHRydWUsCiAgImNvbG9yIjogInllbGxvdyIsCiAgImRhc2hBcnJheSI6IG51bGwsCiAgImRhc2hPZmZzZXQiOiBudWxsLAogICJmaWxsIjogdHJ1ZSwKICAiZmlsbENvbG9yIjogImJsdWUiLAogICJmaWxsT3BhY2l0eSI6IDAuNiwKICAiZmlsbFJ1bGUiOiAiZXZlbm9kZCIsCiAgImxpbmVDYXAiOiAicm91bmQiLAogICJsaW5lSm9pbiI6ICJyb3VuZCIsCiAgIm9wYWNpdHkiOiAxLjAsCiAgInJhZGl1cyI6IDYuNSwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8wNGFmZGQ1YmRlZTA0ZmYzOTI2MmE5MjY2OTg1NGVjNyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8yZTcwZDZkMWVjODQ0YzhjYjZhYTNiMmMxNjdiOWI3YyA9ICQoJzxkaXYgaWQ9Imh0bWxfMmU3MGQ2ZDFlYzg0NGM4Y2I2YWEzYjJjMTY3YjliN2MiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPlRoZSBSb2FkczwvZGl2PicpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMDRhZmRkNWJkZWUwNGZmMzkyNjJhOTI2Njk4NTRlYzcuc2V0Q29udGVudChodG1sXzJlNzBkNmQxZWM4NDRjOGNiNmFhM2IyYzE2N2I5YjdjKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBjaXJjbGVfbWFya2VyXzc3OGZhMmQxNTRlYjQxOTg5ZTExZjU0OGRkNDEwMTE4LmJpbmRQb3B1cChwb3B1cF8wNGFmZGQ1YmRlZTA0ZmYzOTI2MmE5MjY2OTg1NGVjNyk7CgogICAgICAgICAgICAKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgY2lyY2xlX21hcmtlcl8wYWFjY2IzM2ZkMDM0NzhhOWQ3Y2FhNTAxNjRjZjczYyA9IEwuY2lyY2xlTWFya2VyKAogICAgICAgICAgICAgICAgWzI1LjgzLC04MC4xODNdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAieWVsbG93IiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMi4wLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2FiMzNiMTQ3ZDc5NjQwZGI5NmEyYzRiOTM0YTkyNzYwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzg1NWQxMzY0N2I1NTQwYjdiY2I0NDEyZGRmOGRlOTVhID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2ZjZjRmNzQ3NWVlMzQ2NWU4ZjMzOTA4NmMxNzdjMjhhID0gJCgnPGRpdiBpZD0iaHRtbF9mY2Y0Zjc0NzVlZTM0NjVlOGYzMzkwODZjMTc3YzI4YSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+VXBwZXIgRWFzdHNpZGU8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzg1NWQxMzY0N2I1NTQwYjdiY2I0NDEyZGRmOGRlOTVhLnNldENvbnRlbnQoaHRtbF9mY2Y0Zjc0NzVlZTM0NjVlOGYzMzkwODZjMTc3YzI4YSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl8wYWFjY2IzM2ZkMDM0NzhhOWQ3Y2FhNTAxNjRjZjczYy5iaW5kUG9wdXAocG9wdXBfODU1ZDEzNjQ3YjU1NDBiN2JjYjQ0MTJkZGY4ZGU5NWEpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIGNpcmNsZV9tYXJrZXJfYjRhYjBkY2QzMGQ0NGJhZThkNTBlMWJmNTA1OTdmNmYgPSBMLmNpcmNsZU1hcmtlcigKICAgICAgICAgICAgICAgIFsyNS43OTEsLTgwLjE2MV0sCiAgICAgICAgICAgICAgICB7CiAgImJ1YmJsaW5nTW91c2VFdmVudHMiOiB0cnVlLAogICJjb2xvciI6ICJ5ZWxsb3ciLAogICJkYXNoQXJyYXkiOiBudWxsLAogICJkYXNoT2Zmc2V0IjogbnVsbCwKICAiZmlsbCI6IHRydWUsCiAgImZpbGxDb2xvciI6ICJibHVlIiwKICAiZmlsbE9wYWNpdHkiOiAwLjYsCiAgImZpbGxSdWxlIjogImV2ZW5vZGQiLAogICJsaW5lQ2FwIjogInJvdW5kIiwKICAibGluZUpvaW4iOiAicm91bmQiLAogICJvcGFjaXR5IjogMS4wLAogICJyYWRpdXMiOiAwLjUsCiAgInN0cm9rZSI6IHRydWUsCiAgIndlaWdodCI6IDMKfQogICAgICAgICAgICAgICAgKS5hZGRUbyhtYXBfYWIzM2IxNDdkNzk2NDBkYjk2YTJjNGI5MzRhOTI3NjApOwogICAgICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfMGUyNDkzMjMyZGIwNGU0MjgwYTkxNjM5ZjRmNzRkNmIgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNDRjODE1OGMyYTY0NGUwNGI1YzMxZGNhYWY5ZTQ3NWEgPSAkKCc8ZGl2IGlkPSJodG1sXzQ0YzgxNThjMmE2NDRlMDRiNWMzMWRjYWFmOWU0NzVhIiBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij5WZW5ldGlhbiBJc2xhbmRzPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8wZTI0OTMyMzJkYjA0ZTQyODBhOTE2MzlmNGY3NGQ2Yi5zZXRDb250ZW50KGh0bWxfNDRjODE1OGMyYTY0NGUwNGI1YzMxZGNhYWY5ZTQ3NWEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfYjRhYjBkY2QzMGQ0NGJhZThkNTBlMWJmNTA1OTdmNmYuYmluZFBvcHVwKHBvcHVwXzBlMjQ5MzIzMmRiMDRlNDI4MGE5MTYzOWY0Zjc0ZDZiKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzUzYWY5MDFhYThjNDQxODdhYWM2YTQ2MzAyNjlhMjQwID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuNzM2LC04MC4xNTVdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAieWVsbG93IiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMS4wLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2FiMzNiMTQ3ZDc5NjQwZGI5NmEyYzRiOTM0YTkyNzYwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzgxOGQ2NDMzMGM5YzQ0ZmRiNGQ2YjdlN2UzZWNkMWE0ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzgwN2M3MzBmYjI3ZTRhMThhM2Y5NTQxZWY0ODQ3YmYxID0gJCgnPGRpdiBpZD0iaHRtbF84MDdjNzMwZmIyN2U0YTE4YTNmOTU0MWVmNDg0N2JmMSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+VmlyZ2luaWEgS2V5PC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF84MThkNjQzMzBjOWM0NGZkYjRkNmI3ZTdlM2VjZDFhNC5zZXRDb250ZW50KGh0bWxfODA3YzczMGZiMjdlNGExOGEzZjk1NDFlZjQ4NDdiZjEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfNTNhZjkwMWFhOGM0NDE4N2FhYzZhNDYzMDI2OWEyNDAuYmluZFBvcHVwKHBvcHVwXzgxOGQ2NDMzMGM5YzQ0ZmRiNGQ2YjdlN2UzZWNkMWE0KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyXzI5ZDA2ZWQzNTI1NjRlNGViOTUwMzM1MWIxOGZmYTVmID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuNzc1LC04MC4yNDNdLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAieWVsbG93IiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogNi4wLAogICJzdHJva2UiOiB0cnVlLAogICJ3ZWlnaHQiOiAzCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwX2FiMzNiMTQ3ZDc5NjQwZGI5NmEyYzRiOTM0YTkyNzYwKTsKICAgICAgICAgICAgCiAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2M3NzA3OGFmMWQzYjRlYzNhOWYxMThlZTYxNWM0MjIyID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2UwNWNiN2ZjNjE5ODQzOWFhMWU2NmJhOWFmZmYzMDY5ID0gJCgnPGRpdiBpZD0iaHRtbF9lMDVjYjdmYzYxOTg0MzlhYTFlNjZiYTlhZmZmMzA2OSIgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+V2VzdCBGbGFnbGVyPC9kaXY+JylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9jNzcwNzhhZjFkM2I0ZWMzYTlmMTE4ZWU2MTVjNDIyMi5zZXRDb250ZW50KGh0bWxfZTA1Y2I3ZmM2MTk4NDM5YWExZTY2YmE5YWZmZjMwNjkpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIGNpcmNsZV9tYXJrZXJfMjlkMDZlZDM1MjU2NGU0ZWI5NTAzMzUxYjE4ZmZhNWYuYmluZFBvcHVwKHBvcHVwX2M3NzA3OGFmMWQzYjRlYzNhOWYxMThlZTYxNWM0MjIyKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBjaXJjbGVfbWFya2VyX2Q2MzQxOWZjYjg1YTQ3YmI5NzIxODM5NTg1OTc5M2I5ID0gTC5jaXJjbGVNYXJrZXIoCiAgICAgICAgICAgICAgICBbMjUuODA0MDAwMDAwMDAwMDAyLC04MC4xOTldLAogICAgICAgICAgICAgICAgewogICJidWJibGluZ01vdXNlRXZlbnRzIjogdHJ1ZSwKICAiY29sb3IiOiAieWVsbG93IiwKICAiZGFzaEFycmF5IjogbnVsbCwKICAiZGFzaE9mZnNldCI6IG51bGwsCiAgImZpbGwiOiB0cnVlLAogICJmaWxsQ29sb3IiOiAiYmx1ZSIsCiAgImZpbGxPcGFjaXR5IjogMC42LAogICJmaWxsUnVsZSI6ICJldmVub2RkIiwKICAibGluZUNhcCI6ICJyb3VuZCIsCiAgImxpbmVKb2luIjogInJvdW5kIiwKICAib3BhY2l0eSI6IDEuMCwKICAicmFkaXVzIjogMTMuMCwKICAic3Ryb2tlIjogdHJ1ZSwKICAid2VpZ2h0IjogMwp9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9hYjMzYjE0N2Q3OTY0MGRiOTZhMmM0YjkzNGE5Mjc2MCk7CiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9mNDJhNWRlZDA5ZGM0ZjA4ODc3ODMxNjIzMWNlYmYwNyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF85MGY1NTdhOGZkNTg0MmQ1YjAyNjUwMjYwOTE3YTI4YiA9ICQoJzxkaXYgaWQ9Imh0bWxfOTBmNTU3YThmZDU4NDJkNWIwMjY1MDI2MDkxN2EyOGIiIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPld5bndvb2Q8L2Rpdj4nKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2Y0MmE1ZGVkMDlkYzRmMDg4Nzc4MzE2MjMxY2ViZjA3LnNldENvbnRlbnQoaHRtbF85MGY1NTdhOGZkNTg0MmQ1YjAyNjUwMjYwOTE3YTI4Yik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgY2lyY2xlX21hcmtlcl9kNjM0MTlmY2I4NWE0N2JiOTcyMTgzOTU4NTk3OTNiOS5iaW5kUG9wdXAocG9wdXBfZjQyYTVkZWQwOWRjNGYwODg3NzgzMTYyMzFjZWJmMDcpOwoKICAgICAgICAgICAgCiAgICAgICAgCjwvc2NyaXB0Pg== onload=\"this.contentDocument.open();this.contentDocument.write(atob(this.getAttribute('data-html')));this.contentDocument.close();\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>"
      ],
      "text/plain": [
       "<folium.folium.Map at 0x192b3b89a90>"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from folium import plugins\n",
    "\n",
    "# let's start again with a clean copy of the map of San Francisco\n",
    "miami_map = folium.Map(location = [latitude, longitude], zoom_start = 12)\n",
    "\n",
    "for lat, lng, label, size in zip(miami_merged.Latitude, miami_merged.Longitude, miami_merged.Neighborhood,miami_merged.NumberOfInstitutes):\n",
    "    folium.features.CircleMarker(\n",
    "        [lat, lng],\n",
    "        radius=size/2, # define how big you want the circle markers to be\n",
    "        color='yellow',\n",
    "        fill=True,\n",
    "        popup=label,\n",
    "        fill_color='blue',\n",
    "        fill_opacity=0.6\n",
    "    ).add_to(miami_map)\n",
    "    \n",
    "# display map\n",
    "miami_map"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a id='item5'></a>\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Results and Discussion <a name=\"results\"></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Our analysis shows that although there is a great number of educational institutes in Miami, when moving away from city center its density is reducing. Highest concentration of educational institutes was detected near to the coastal area especially souther area of the city. So we focused our attention  to areas northern & costal  area . \n",
    "\n",
    "\n",
    "By considering data and exploring the map we can see that area near to Midtown neighborhood is most suitable  for requirement.\n",
    "\n",
    "We are also providing 1st Most Common institute type\t2nd Most Common institute type, so other than educational institutes density user can also select residence based on institute type also."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Conclusion <a name=\"conclusion\"></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Purpose of this project was to identify Miami areas with high number of educational institutions in order to aid stakeholders in narrowing down the search for optimal location for their residence. By calculating educational institutions density distribution from Foursquare data we have identified. \n",
    "\n",
    "By considering data and map we can see that area near to Midtown neighborhood is most suitable for requirement.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  },
  "widgets": {
   "state": {},
   "version": "1.1.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
